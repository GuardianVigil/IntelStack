INFO 2025-02-04 01:10:26,016 autoreload 35800 135304547152000 Watching for file changes with StatReloader
INFO 2025-02-04 01:10:33,468 autoreload 35800 135304547152000 /home/Agile/code/Stack/vristo/settings.py changed, reloading.
INFO 2025-02-04 01:10:33,849 autoreload 35869 135341850783872 Watching for file changes with StatReloader
INFO 2025-02-04 01:10:46,453 autoreload 35976 139978924753024 Watching for file changes with StatReloader
ERROR 2025-02-04 01:10:51,747 views 35976 139978753443520 IP Analysis error for 8.8.8.8: You cannot call this from an async context - use a thread or sync_to_async.
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 785, in ip_analysis
    async with IPAnalysisService(request.user) as service:
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 56, in __aenter__
    await self._load_api_keys()
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 68, in _load_api_keys
    api_keys = APIKey.objects.filter(user=self.user, platform__in=platforms)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1609, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1641, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1500, in build_filter
    value = self.resolve_lookup_value(value, can_reuse, allow_joins, summarize)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1269, in resolve_lookup_value
    if hasattr(value, "resolve_expression"):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/functional.py", line 251, in inner
    self._setup()
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/functional.py", line 404, in _setup
    self._wrapped = self._setupfunc()
                    ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/middleware.py", line 37, in <lambda>
    request.user = SimpleLazyObject(lambda: get_user(request))
                                            ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/middleware.py", line 17, in get_user
    request._cached_user = auth.get_user(request)
                           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/__init__.py", line 216, in get_user
    user = backend.get_user(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/backends.py", line 157, in get_user
    user = UserModel._default_manager.get(pk=user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 382, in __len__
    self._fetch_all()
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1572, in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/asyncio.py", line 24, in inner
    raise SynchronousOnlyOperation(message)
django.core.exceptions.SynchronousOnlyOperation: You cannot call this from an async context - use a thread or sync_to_async.
ERROR 2025-02-04 01:10:51,750 base_events 35976 139978753443520 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4f5e8c6de0>
ERROR 2025-02-04 01:11:04,142 views 35976 139978835232448 IP Analysis error for 8.8.8.8: You cannot call this from an async context - use a thread or sync_to_async.
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 785, in ip_analysis
    async with IPAnalysisService(request.user) as service:
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 56, in __aenter__
    await self._load_api_keys()
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 68, in _load_api_keys
    api_keys = APIKey.objects.filter(user=self.user, platform__in=platforms)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1476, in filter
    return self._filter_or_exclude(False, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1494, in _filter_or_exclude
    clone._filter_or_exclude_inplace(negate, args, kwargs)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1501, in _filter_or_exclude_inplace
    self._query.add_q(Q(*args, **kwargs))
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1609, in add_q
    clause, _ = self._add_q(q_object, self.used_aliases)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1641, in _add_q
    child_clause, needed_inner = self.build_filter(
                                 ^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1500, in build_filter
    value = self.resolve_lookup_value(value, can_reuse, allow_joins, summarize)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/query.py", line 1269, in resolve_lookup_value
    if hasattr(value, "resolve_expression"):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/functional.py", line 251, in inner
    self._setup()
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/functional.py", line 404, in _setup
    self._wrapped = self._setupfunc()
                    ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/middleware.py", line 37, in <lambda>
    request.user = SimpleLazyObject(lambda: get_user(request))
                                            ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/middleware.py", line 17, in get_user
    request._cached_user = auth.get_user(request)
                           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/__init__.py", line 216, in get_user
    user = backend.get_user(user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/backends.py", line 157, in get_user
    user = UserModel._default_manager.get(pk=user_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/manager.py", line 87, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 645, in get
    num = len(clone)
          ^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 382, in __len__
    self._fetch_all()
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 1928, in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/query.py", line 91, in __iter__
    results = compiler.execute_sql(
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py", line 1572, in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/utils/asyncio.py", line 24, in inner
    raise SynchronousOnlyOperation(message)
django.core.exceptions.SynchronousOnlyOperation: You cannot call this from an async context - use a thread or sync_to_async.
ERROR 2025-02-04 01:11:04,144 base_events 35976 139978835232448 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7f4f5e2b2c60>
INFO 2025-02-04 01:11:54,559 autoreload 35976 139978924753024 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-04 01:11:55,017 autoreload 36312 126865143689344 Watching for file changes with StatReloader
INFO 2025-02-04 01:12:17,786 autoreload 36312 126865143689344 /home/Agile/code/Stack/main/services/ip_analysis.py changed, reloading.
INFO 2025-02-04 01:12:18,192 autoreload 36427 127412474253440 Watching for file changes with StatReloader
INFO 2025-02-04 01:13:01,251 autoreload 36427 127412474253440 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-04 01:13:01,833 autoreload 36645 127493650063488 Watching for file changes with StatReloader
ERROR 2025-02-04 01:13:43,097 views 36645 127493581309632 Unexpected error in ip_analysis view: layouts/base.html
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 846, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html
ERROR 2025-02-04 01:13:43,152 log 36645 127493581309632 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 846, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 784, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 850, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html
ERROR 2025-02-04 01:13:47,417 views 36645 127493581309632 Unexpected error in ip_analysis view: layouts/base.html
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 846, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html
ERROR 2025-02-04 01:13:47,454 log 36645 127493581309632 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 846, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/base.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 784, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 850, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/base.html
INFO 2025-02-04 01:14:21,409 autoreload 36645 127493650063488 /home/Agile/code/Stack/vristo/settings.py changed, reloading.
INFO 2025-02-04 01:14:21,823 autoreload 37013 135546519629952 Watching for file changes with StatReloader
INFO 2025-02-04 01:14:33,030 autoreload 37092 140428476694656 Watching for file changes with StatReloader
ERROR 2025-02-04 01:16:12,903 ip_analysis 37092 140428315723456 Error getting API key for virustotal: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
ERROR 2025-02-04 01:16:12,910 ip_analysis 37092 140428315723456 Error getting API key for alienvault: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
ERROR 2025-02-04 01:16:12,912 ip_analysis 37092 140428315723456 Error getting API key for ibmxforce: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
ERROR 2025-02-04 01:16:13,458 base_events 37092 140428476694656 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7fb8096fc260>
INFO 2025-02-04 01:21:01,331 autoreload 38978 139047083962496 Watching for file changes with StatReloader
ERROR 2025-02-04 01:21:56,111 ip_analysis 38978 139046946866880 Error getting API key for virustotal: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
ERROR 2025-02-04 01:21:56,114 ip_analysis 38978 139046946866880 Error getting API key for alienvault: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
ERROR 2025-02-04 01:21:56,116 ip_analysis 38978 139046946866880 Error getting API key for ibmxforce: 'Settings' object has no attribute 'API_KEYS'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in _get_api_key
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 36, in <lambda>
    encrypted_key = await sync_to_async(lambda: settings.API_KEYS.get(platform))()
                                                ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/conf/__init__.py", line 83, in __getattr__
    val = getattr(_wrapped, name)
          ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'Settings' object has no attribute 'API_KEYS'
INFO 2025-02-04 01:22:35,677 autoreload 38978 139047083962496 /home/Agile/code/Stack/vristo/settings.py changed, reloading.
ERROR 2025-02-04 01:22:35,706 base_events 38978 139047083962496 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7e76682bac30>
INFO 2025-02-04 01:22:36,080 autoreload 39416 124954850791552 Watching for file changes with StatReloader
INFO 2025-02-04 01:22:53,669 autoreload 39416 124954850791552 /home/Agile/code/Stack/main/services/ip_analysis.py changed, reloading.
INFO 2025-02-04 01:22:54,178 autoreload 39516 123143546282112 Watching for file changes with StatReloader
INFO 2025-02-04 01:23:06,054 views 39516 123143477790400 Returning cached result for IP: 93.127.57.211
INFO 2025-02-04 01:25:26,035 autoreload 39516 123143546282112 /home/Agile/code/Stack/main/models.py changed, reloading.
INFO 2025-02-04 01:25:26,417 autoreload 40129 125053771362432 Watching for file changes with StatReloader
INFO 2025-02-04 01:25:52,095 autoreload 40129 125053771362432 /home/Agile/code/Stack/main/services/ip_analysis.py changed, reloading.
INFO 2025-02-04 01:25:52,598 autoreload 40268 124708680134784 Watching for file changes with StatReloader
INFO 2025-02-04 01:28:25,229 autoreload 40919 133089711128704 Watching for file changes with StatReloader
ERROR 2025-02-04 01:28:33,732 ip_analysis 40919 133089642677952 Error getting API key for virustotal: 'APIKey' object has no attribute 'get_decrypted_key'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 44, in _get_api_key
    decrypted_key = await sync_to_async(api_key.get_decrypted_key)()
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'APIKey' object has no attribute 'get_decrypted_key'. Did you mean: 'get_decrypted_api_key'?
ERROR 2025-02-04 01:28:33,737 ip_analysis 40919 133089642677952 Error getting API key for alienvault: 'APIKey' object has no attribute 'get_decrypted_key'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/services/ip_analysis.py", line 44, in _get_api_key
    decrypted_key = await sync_to_async(api_key.get_decrypted_key)()
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'APIKey' object has no attribute 'get_decrypted_key'. Did you mean: 'get_decrypted_api_key'?
WARNING 2025-02-04 01:28:33,741 ip_analysis 40919 133089642677952 No API key configured for ibmxforce
INFO 2025-02-04 01:29:36,333 autoreload 40919 133089711128704 /home/Agile/code/Stack/main/services/ip_analysis.py changed, reloading.
INFO 2025-02-04 01:29:36,966 autoreload 41219 140228063031424 Watching for file changes with StatReloader
WARNING 2025-02-04 01:29:45,149 ip_analysis 41219 140227926558400 No API key configured for ibmxforce
INFO 2025-02-04 01:30:46,088 autoreload 41219 140228063031424 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-04 01:30:46,561 autoreload 41532 139923115016320 Watching for file changes with StatReloader
WARNING 2025-02-04 01:30:55,571 ip_analysis 41532 139922979686080 No API key configured for ibmxforce
WARNING 2025-02-04 01:31:18,022 ip_analysis 41532 139922979686080 No API key configured for ibmxforce
INFO 2025-02-04 01:38:14,324 autoreload 43406 135602964607104 Watching for file changes with StatReloader
WARNING 2025-02-04 01:38:25,084 ip_analysis 43406 135602894800576 No API key configured for ibmxforce
WARNING 2025-02-04 01:44:54,368 ip_analysis 43406 135602894800576 No API key configured for ibmxforce
WARNING 2025-02-04 01:45:44,494 ip_analysis 43406 135602884314816 No API key configured for ibmxforce
INFO 2025-02-04 02:36:09,795 autoreload 55427 131121033973888 Watching for file changes with StatReloader
INFO 2025-02-04 02:38:42,101 autoreload 55985 139254194282624 Watching for file changes with StatReloader
WARNING 2025-02-04 02:39:45,969 ip_analysis 55985 139254124512960 No API key configured for ibmxforce
WARNING 2025-02-04 02:40:16,604 ip_analysis 55985 139254124512960 No API key configured for ibmxforce
WARNING 2025-02-04 02:40:24,580 ip_analysis 55985 139254124512960 No API key configured for ibmxforce
INFO 2025-02-04 22:17:40,028 autoreload 3607 130177604731008 Watching for file changes with StatReloader
WARNING 2025-02-04 22:31:43,662 ip_analysis 3607 130177524827840 No API key configured for ibmxforce
WARNING 2025-02-04 22:35:39,973 ip_analysis 3607 130177524827840 No API key configured for ibmxforce
INFO 2025-02-04 22:47:56,250 autoreload 10184 130816399929472 Watching for file changes with StatReloader
INFO 2025-02-04 22:50:16,359 autoreload 10713 125862561640576 Watching for file changes with StatReloader
INFO 2025-02-04 22:59:43,787 autoreload 10713 125862561640576 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-04 22:59:44,201 autoreload 12650 129989985611904 Watching for file changes with StatReloader
INFO 2025-02-04 23:00:08,949 autoreload 12650 129989985611904 /home/Agile/code/Stack/main/urls.py changed, reloading.
INFO 2025-02-04 23:00:09,342 autoreload 12781 129493699444864 Watching for file changes with StatReloader
INFO 2025-02-04 23:06:43,027 autoreload 14429 130630874419328 Watching for file changes with StatReloader
INFO 2025-02-04 23:06:59,536 autoreload 14570 140257366265984 Watching for file changes with StatReloader
ERROR 2025-02-04 23:07:13,918 views 14570 140257292977856 Error getting WHOIS info: module 'whois' has no attribute 'whois'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 834, in analyze_ip_api
    whois_result = await sync_to_async(lambda: whois.whois(ip_address))()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 834, in <lambda>
    whois_result = await sync_to_async(lambda: whois.whois(ip_address))()
                                               ^^^^^^^^^^^
AttributeError: module 'whois' has no attribute 'whois'
ERROR 2025-02-04 23:07:27,120 views 14570 140257292977856 Error getting WHOIS info: module 'whois' has no attribute 'whois'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 834, in analyze_ip_api
    whois_result = await sync_to_async(lambda: whois.whois(ip_address))()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 468, in __call__
    ret = await asyncio.shield(exec_coro)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/asgiref/sync.py", line 522, in thread_handler
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 834, in <lambda>
    whois_result = await sync_to_async(lambda: whois.whois(ip_address))()
                                               ^^^^^^^^^^^
AttributeError: module 'whois' has no attribute 'whois'
INFO 2025-02-04 23:11:04,232 autoreload 14570 140257366265984 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-04 23:11:04,619 autoreload 15554 136425240412288 Watching for file changes with StatReloader
INFO 2025-02-04 23:14:22,030 autoreload 16457 136160579838080 Watching for file changes with StatReloader
INFO 2025-02-04 23:18:54,424 autoreload 17463 127043715055744 Watching for file changes with StatReloader
INFO 2025-02-04 23:27:13,591 autoreload 19443 129128976912512 Watching for file changes with StatReloader
INFO 2025-02-05 00:47:53,541 autoreload 36474 129537826717824 Watching for file changes with StatReloader
INFO 2025-02-05 01:03:48,895 autoreload 40211 140208258916480 Watching for file changes with StatReloader
INFO 2025-02-05 01:41:44,327 autoreload 48819 124821120848000 Watching for file changes with StatReloader
INFO 2025-02-07 21:31:13,633 autoreload 28142 130204452552832 Watching for file changes with StatReloader
ERROR 2025-02-07 21:31:16,160 log 28142 130204383053504 Internal Server Error: /login/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1035, in find_library
    return parser.libraries[name]
           ~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'tailwind_tags'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 609, in login_view
    return render(request, 'auth/login.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1097, in load
    lib = find_library(parser, name)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1037, in find_library
    raise TemplateSyntaxError(
django.template.exceptions.TemplateSyntaxError: 'tailwind_tags' is not a registered tag library. Must be one of:
admin_list
admin_modify
admin_urls
cache
i18n
l10n
log
static
tz
INFO 2025-02-07 21:32:51,623 autoreload 28563 132330970112128 Watching for file changes with StatReloader
ERROR 2025-02-07 21:32:55,272 log 28563 132330815489728 Internal Server Error: /login/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1035, in find_library
    return parser.libraries[name]
           ~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'tailwind_tags'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 609, in login_view
    return render(request, 'auth/login.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1097, in load
    lib = find_library(parser, name)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1037, in find_library
    raise TemplateSyntaxError(
django.template.exceptions.TemplateSyntaxError: 'tailwind_tags' is not a registered tag library. Must be one of:
admin_list
admin_modify
admin_urls
cache
i18n
l10n
log
static
tz
INFO 2025-02-07 21:33:53,988 autoreload 28904 123459154587776 Watching for file changes with StatReloader
ERROR 2025-02-07 21:34:24,577 log 28904 123459084486336 Internal Server Error: /
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1035, in find_library
    return parser.libraries[name]
           ~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'tailwind_tags'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 33, in index
    return render(request, 'index.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1097, in load
    lib = find_library(parser, name)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/defaulttags.py", line 1037, in find_library
    raise TemplateSyntaxError(
django.template.exceptions.TemplateSyntaxError: 'tailwind_tags' is not a registered tag library. Must be one of:
admin_list
admin_modify
admin_urls
cache
i18n
l10n
log
static
tz
INFO 2025-02-07 21:35:49,559 autoreload 29542 128297903300736 Watching for file changes with StatReloader
WARNING 2025-02-07 21:49:12,714 ip_analysis 29542 128297824421568 No API key configured for virustotal
WARNING 2025-02-07 21:49:12,716 ip_analysis 29542 128297824421568 No API key configured for abuseipdb
WARNING 2025-02-07 21:49:12,718 ip_analysis 29542 128297824421568 No API key configured for crowdsec
WARNING 2025-02-07 21:49:12,720 ip_analysis 29542 128297824421568 No API key configured for greynoise
WARNING 2025-02-07 21:49:12,721 ip_analysis 29542 128297824421568 No API key configured for securitytrails
INFO 2025-02-07 23:43:19,473 autoreload 54545 126934173585536 Watching for file changes with StatReloader
ERROR 2025-02-08 00:11:03,518 views 54545 126934105196224 Error analyzing IP: layouts/app.html
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/app.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/app.html
ERROR 2025-02-08 00:11:03,583 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/app.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/app.html

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 107, in render
    return self.template.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 171, in render
    return self._render(context)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 163, in _render
    return self.nodelist.render(context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 1008, in render
    return SafeString("".join([node.render_annotated(context) for node in self]))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 969, in render_annotated
    return self.render(context)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 134, in render
    compiled_parent = self.get_parent(context)
                      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 131, in get_parent
    return self.find_template(parent, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 109, in find_template
    template, origin = context.template.engine.find_template(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 163, in find_template
    raise TemplateDoesNotExist(name, tried=tried)
django.template.exceptions.TemplateDoesNotExist: layouts/app.html

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 62, in render_to_string
    return template.render(context, request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 109, in render
    reraise(exc, self.backend)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 130, in reraise
    raise new from exc
django.template.exceptions.TemplateDoesNotExist: layouts/app.html
ERROR 2025-02-08 00:11:47,381 views 54545 126934105196224 Error analyzing IP: Invalid block tag on line 682: 'endblock'. Did you forget to register or load this tag?
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 682: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:11:47,452 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 682: 'endblock'. Did you forget to register or load this tag?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 682: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:11:53,029 views 54545 126934105196224 Error analyzing IP: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:11:53,094 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:12:05,268 views 54545 126934105196224 Error analyzing IP: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:12:05,335 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:12:14,037 views 54545 126934105196224 Error analyzing IP: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:12:14,105 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:14:31,354 views 54545 126934105196224 Error analyzing IP: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
ERROR 2025-02-08 00:14:31,436 log 54545 126934105196224 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 811, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 510, in parse
    compile_func = self.tags[command]
                   ~~~~~~~~~^^^^^^^^^
KeyError: 'endblock'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 785, in wrapped
    return asyncio.run(f(*args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/views.py", line 815, in ip_analysis
    return render(request, 'threat/ip_analysis.html', {
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 15, in get_template
    return engine.get_template(template_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/backends/django.py", line 79, in get_template
    return Template(self.engine.get_template(template_name), self)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 177, in get_template
    template, origin = self.find_template(template_name)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/engine.py", line 159, in find_template
    template = loader.get_template(name, skip=skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/cached.py", line 57, in get_template
    template = super().get_template(template_name, skip)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loaders/base.py", line 28, in get_template
    return Template(
           ^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 154, in __init__
    self.nodelist = self.compile_nodelist()
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 196, in compile_nodelist
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 518, in parse
    raise self.error(token, e)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 516, in parse
    compiled_result = compile_func(self, token)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/loader_tags.py", line 295, in do_extends
    nodelist = parser.parse()
               ^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 512, in parse
    self.invalid_block_tag(token, command, parse_until)
  File "/home/Agile/code/Stack/venv/lib/python3.12/site-packages/django/template/base.py", line 573, in invalid_block_tag
    raise self.error(
django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 649: 'endblock'. Did you forget to register or load this tag?
INFO 2025-02-08 01:34:49,329 autoreload 81120 137988481732736 Watching for file changes with StatReloader
INFO 2025-02-08 01:42:46,722 autoreload 81120 137988481732736 /home/Agile/code/Stack/main/urls.py changed, reloading.
INFO 2025-02-08 01:42:47,201 autoreload 83063 138227409109120 Watching for file changes with StatReloader
INFO 2025-02-08 01:42:57,543 autoreload 83063 138227409109120 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-08 01:42:58,081 autoreload 83141 126193254203520 Watching for file changes with StatReloader
INFO 2025-02-08 01:43:21,637 autoreload 83141 126193254203520 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-08 01:43:22,073 autoreload 83266 128343201984640 Watching for file changes with StatReloader
INFO 2025-02-08 01:43:29,394 autoreload 83266 128343201984640 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-08 01:43:29,978 autoreload 83333 139358022803584 Watching for file changes with StatReloader
INFO 2025-02-08 01:44:22,938 autoreload 83333 139358022803584 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 01:44:23,549 autoreload 83546 134463027957888 Watching for file changes with StatReloader
INFO 2025-02-08 01:44:37,281 autoreload 83647 140112011067520 Watching for file changes with StatReloader
INFO 2025-02-08 01:45:10,039 autoreload 83647 140112011067520 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 01:45:10,712 autoreload 83797 126158816747648 Watching for file changes with StatReloader
INFO 2025-02-08 01:45:22,227 autoreload 83797 126158816747648 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 01:45:22,868 autoreload 83877 126697592045696 Watching for file changes with StatReloader
INFO 2025-02-08 01:45:31,388 autoreload 83877 126697592045696 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 01:45:31,876 autoreload 83946 138993489858688 Watching for file changes with StatReloader
INFO 2025-02-08 01:45:59,586 autoreload 83946 138993489858688 /home/Agile/code/Stack/main/services/ip_scan/threat_score.py changed, reloading.
INFO 2025-02-08 01:46:00,082 autoreload 84059 134908030595200 Watching for file changes with StatReloader
INFO 2025-02-08 01:46:26,752 autoreload 84059 134908030595200 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 01:46:27,208 autoreload 84191 136568201212032 Watching for file changes with StatReloader
INFO 2025-02-08 01:51:23,981 autoreload 85410 130808324030592 Watching for file changes with StatReloader
INFO 2025-02-08 01:51:25,392 autoreload 85410 130808324030592 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 01:51:25,912 autoreload 85434 137080823312512 Watching for file changes with StatReloader
INFO 2025-02-08 01:51:46,637 autoreload 85434 137080823312512 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 01:51:47,127 autoreload 85551 127292389728384 Watching for file changes with StatReloader
INFO 2025-02-08 01:52:05,617 autoreload 85654 131319848726656 Watching for file changes with StatReloader
INFO 2025-02-08 01:53:09,714 autoreload 85654 131319848726656 /home/Agile/code/Stack/main/views.py changed, reloading.
INFO 2025-02-08 01:53:10,643 autoreload 85910 128769752858752 Watching for file changes with StatReloader
INFO 2025-02-08 01:53:37,672 ip_analysis 85910 128769685718720 Cache is available
ERROR 2025-02-08 01:53:37,744 ip_analysis 85910 128769685718720 SecurityTrails API error: 404
INFO 2025-02-08 01:53:37,947 ip_analysis 85910 128769685718720 Cached result for 80.64.30.85
INFO 2025-02-08 01:56:47,980 autoreload 85910 128769752858752 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 01:56:48,677 autoreload 86781 127242554028160 Watching for file changes with StatReloader
INFO 2025-02-08 01:57:07,425 ip_analysis 86781 127242476717760 Cache is available
INFO 2025-02-08 01:57:07,428 ip_analysis 86781 127242476717760 Found cached result for 80.64.30.85
INFO 2025-02-08 01:58:06,501 ip_analysis 86781 127242476717760 Cache is available
ERROR 2025-02-08 01:58:06,600 ip_analysis 86781 127242476717760 SecurityTrails API error: 404
INFO 2025-02-08 01:58:06,728 ip_analysis 86781 127242476717760 Cached result for 122.171.20.211
INFO 2025-02-08 02:00:58,919 autoreload 86781 127242554028160 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 02:00:59,374 autoreload 87766 127653091266688 Watching for file changes with StatReloader
INFO 2025-02-08 02:01:13,925 autoreload 87766 127653091266688 /home/Agile/code/Stack/main/services/ip_scan/threat_score.py changed, reloading.
INFO 2025-02-08 02:01:14,416 autoreload 87865 137248881205376 Watching for file changes with StatReloader
INFO 2025-02-08 02:11:06,129 ip_analysis 87865 137248802604736 Cache is available
ERROR 2025-02-08 02:11:06,209 ip_analysis 87865 137248802604736 SecurityTrails API error: 404
INFO 2025-02-08 02:11:06,420 ip_analysis 87865 137248802604736 Cached result for 105.27.192.254
INFO 2025-02-08 02:33:06,210 autoreload 87865 137248881205376 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 02:33:06,670 autoreload 94488 135937470038144 Watching for file changes with StatReloader
INFO 2025-02-08 02:36:52,901 ip_analysis 94488 135937323435712 Cache is available
ERROR 2025-02-08 02:36:52,906 views 94488 135937323435712 Error analyzing IP: 'APIKey' object has no attribute 'key'
Traceback (most recent call last):
  File "/home/Agile/code/Stack/main/views.py", line 792, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py", line 188, in analyze_ip
    api_key = await self._get_api_key(platform)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py", line 55, in _get_api_key
    self.api_keys[platform] = api_key.key
                              ^^^^^^^^^^^
AttributeError: 'APIKey' object has no attribute 'key'
ERROR 2025-02-08 02:36:52,908 log 94488 135937323435712 Internal Server Error: /threat/ip-analysis/analyze/14.161.17.210/
INFO 2025-02-08 02:37:40,260 autoreload 94488 135937470038144 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 02:37:40,790 autoreload 95509 131263882752128 Watching for file changes with StatReloader
INFO 2025-02-08 02:37:51,364 ip_analysis 95509 131263727929024 Cache is available
ERROR 2025-02-08 02:37:51,384 ip_analysis 95509 131263727929024 AbuseIPDB request error: Invalid variable type: value should be str, int or float, got True of type <class 'bool'>
ERROR 2025-02-08 02:37:51,674 ip_analysis 95509 131263727929024 CrowdSec request error: Cannot connect to host capi.crowdsec.net:443 ssl:default [Name or service not known]
INFO 2025-02-08 02:37:53,092 ip_analysis 95509 131263727929024 Cached result for 14.161.17.210
INFO 2025-02-08 02:38:35,254 ip_analysis 95509 131263727929024 Cache is available
ERROR 2025-02-08 02:38:35,263 ip_analysis 95509 131263727929024 AbuseIPDB request error: Invalid variable type: value should be str, int or float, got True of type <class 'bool'>
ERROR 2025-02-08 02:38:35,481 ip_analysis 95509 131263727929024 CrowdSec request error: Cannot connect to host capi.crowdsec.net:443 ssl:default [Name or service not known]
INFO 2025-02-08 02:38:36,126 ip_analysis 95509 131263727929024 Cached result for 91.187.39.158
INFO 2025-02-08 02:38:44,169 ip_analysis 95509 131263727929024 Cache is available
INFO 2025-02-08 02:38:44,170 ip_analysis 95509 131263727929024 Found cached result for 91.187.39.158
INFO 2025-02-08 02:40:58,640 autoreload 96390 124954078298240 Watching for file changes with StatReloader
INFO 2025-02-08 02:41:17,574 ip_analysis 96390 124954012026560 Cache is available
ERROR 2025-02-08 02:41:17,589 ip_analysis 96390 124954012026560 AbuseIPDB request error: Invalid variable type: value should be str, int or float, got True of type <class 'bool'>
ERROR 2025-02-08 02:41:17,683 ip_analysis 96390 124954012026560 CrowdSec request error: Cannot connect to host capi.crowdsec.net:443 ssl:default [Name or service not known]
INFO 2025-02-08 02:41:18,865 ip_analysis 96390 124954012026560 Cached result for 115.69.223.178
INFO 2025-02-08 02:43:06,555 autoreload 96390 124954078298240 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 02:43:07,732 autoreload 96948 137137066659968 Watching for file changes with StatReloader
INFO 2025-02-08 02:43:40,708 autoreload 96948 137137066659968 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 02:43:41,219 autoreload 97109 135137646407808 Watching for file changes with StatReloader
INFO 2025-02-08 02:44:21,314 autoreload 97289 135621860544640 Watching for file changes with StatReloader
INFO 2025-02-08 02:44:26,786 ip_analysis 97289 135621710448320 Cache is available
ERROR 2025-02-08 02:44:27,059 ip_analysis 97289 135621710448320 CrowdSec API error: 403
INFO 2025-02-08 02:44:27,635 ip_analysis 97289 135621710448320 Cached result for 132.148.167.243
INFO 2025-02-08 02:46:50,473 autoreload 97289 135621860544640 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 02:46:51,061 autoreload 97980 139598491627648 Watching for file changes with StatReloader
INFO 2025-02-08 02:47:02,695 autoreload 97980 139598491627648 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 02:47:03,200 autoreload 98059 123470698590336 Watching for file changes with StatReloader
INFO 2025-02-08 02:47:48,603 ip_analysis 98059 123470631405248 Cache is available
INFO 2025-02-08 02:47:48,605 ip_analysis 98059 123470631405248 Found cached result for 105.27.192.254
INFO 2025-02-08 02:48:21,329 ip_analysis 98059 123470631405248 Cache is available
INFO 2025-02-08 02:48:21,330 ip_analysis 98059 123470631405248 Found cached result for 14.161.17.210
INFO 2025-02-08 02:48:51,781 ip_analysis 98059 123470631405248 Cache is available
INFO 2025-02-08 02:48:52,856 ip_analysis 98059 123470631405248 Cached result for 186.224.32.6
INFO 2025-02-08 02:53:13,822 ip_analysis 98059 123470631405248 Cache is available
INFO 2025-02-08 02:53:15,716 ip_analysis 98059 123470631405248 Cached result for 2.57.121.138
INFO 2025-02-08 02:54:44,900 ip_analysis 98059 123470631405248 Cache is available
INFO 2025-02-08 02:54:46,776 ip_analysis 98059 123470631405248 Cached result for 170.130.55.170
INFO 2025-02-08 02:56:56,102 autoreload 98059 123470698590336 /home/Agile/code/Stack/main/services/ip_scan/platforms_score.py changed, reloading.
INFO 2025-02-08 02:56:56,644 autoreload 100336 124500435452032 Watching for file changes with StatReloader
INFO 2025-02-08 02:57:26,419 autoreload 100336 124500435452032 /home/Agile/code/Stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-08 02:57:27,069 autoreload 100478 137276398682240 Watching for file changes with StatReloader
INFO 2025-02-08 02:59:01,301 ip_analysis 100478 137276331919040 Cache is available
INFO 2025-02-08 02:59:02,432 ip_analysis 100478 137276331919040 Cached result for 213.14.233.149
INFO 2025-02-08 03:00:14,380 ip_analysis 100478 137276331919040 Cache is available
INFO 2025-02-08 03:00:14,383 ip_analysis 100478 137276331919040 Found cached result for 170.130.55.170
INFO 2025-02-08 03:00:35,831 ip_analysis 100478 137276331919040 Cache is available
INFO 2025-02-08 03:00:40,647 ip_analysis 100478 137276331919040 Cached result for 218.66.32.221
INFO 2025-02-08 03:03:58,813 ip_analysis 100478 137276331919040 Cache is available
INFO 2025-02-08 03:03:58,815 ip_analysis 100478 137276331919040 Found cached result for 218.66.32.221
INFO 2025-02-08 03:05:39,908 ip_analysis 100478 137276331919040 Cache is available
INFO 2025-02-08 03:05:39,909 ip_analysis 100478 137276331919040 Found cached result for 218.66.32.221
INFO 2025-02-09 15:06:15,344 autoreload 6184 136542664020096 Watching for file changes with StatReloader
INFO 2025-02-09 15:12:24,927 autoreload 8054 133334062248064 Watching for file changes with StatReloader
INFO 2025-02-09 15:13:03,175 autoreload 8329 127649231863936 Watching for file changes with StatReloader
INFO 2025-02-09 15:13:39,982 autoreload 8586 123148650492032 Watching for file changes with StatReloader
INFO 2025-02-09 15:15:09,909 autoreload 9126 137930664984704 Watching for file changes with StatReloader
ERROR 2025-02-09 15:15:32,235 log 9126 137930502833856 Internal Server Error: /login/
Traceback (most recent call last):
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 576, in login_view
    user = authenticate(request, username=login_identifier, password=password)
           ^^^^^^^^^^^^
NameError: name 'authenticate' is not defined
INFO 2025-02-09 15:16:39,453 autoreload 9593 133246551380096 Watching for file changes with StatReloader
ERROR 2025-02-09 15:16:55,245 log 9593 133246484481728 Internal Server Error: /register/
Traceback (most recent call last):
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 611, in register_view
    if User.objects.filter(username=username).exists():
       ^^^^
NameError: name 'User' is not defined
INFO 2025-02-09 15:17:08,595 autoreload 9807 138986260873344 Watching for file changes with StatReloader
ERROR 2025-02-09 15:17:18,755 log 9807 138986194470592 Internal Server Error: /register/
Traceback (most recent call last):
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 611, in register_view
    if User.objects.filter(username=username).exists():
       ^^^^
NameError: name 'User' is not defined
INFO 2025-02-09 15:17:57,406 autoreload 9807 138986260873344 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 15:17:57,801 autoreload 10070 132074580000896 Watching for file changes with StatReloader
ERROR 2025-02-09 15:18:30,847 log 10070 132074512058048 Internal Server Error: /login/
Traceback (most recent call last):
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 578, in login_view
    user = authenticate(request, username=login_identifier, password=password)
           ^^^^^^^^^^^^
NameError: name 'authenticate' is not defined
INFO 2025-02-09 15:18:57,892 autoreload 10070 132074580000896 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 15:18:58,302 autoreload 10423 129730078875776 Watching for file changes with StatReloader
ERROR 2025-02-09 16:14:42,041 log 10423 129729887733440 Internal Server Error: /settings/api-configuration/test/
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 162, in test_api_key
    api_key = APIKey.objects.get(user=request.user, platform=platform, is_active=True)
              ^^^^^^
NameError: name 'APIKey' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/Agile/venv/lib/python3.12/site-packages/django/views/decorators/http.py", line 64, in inner
    return func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 231, in test_api_key
    except APIKey.DoesNotExist:
           ^^^^^^
NameError: name 'APIKey' is not defined
INFO 2025-02-09 16:17:03,610 autoreload 23338 136050424582272 Watching for file changes with StatReloader
INFO 2025-02-09 16:23:14,149 autoreload 23338 136050424582272 /home/Agile/code/stack/main/models.py changed, reloading.
INFO 2025-02-09 16:23:14,516 autoreload 25203 123301969670272 Watching for file changes with StatReloader
INFO 2025-02-09 16:23:33,086 autoreload 25203 123301969670272 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 16:23:33,474 autoreload 25311 134725958238336 Watching for file changes with StatReloader
INFO 2025-02-09 16:32:21,869 ip_analysis 25311 134725796628160 Cache is available
ERROR 2025-02-09 16:32:22,036 ip_analysis 25311 134725796628160 GreyNoise API error: 429
INFO 2025-02-09 16:32:23,265 ip_analysis 25311 134725796628160 Cached result for 185.220.101.70
INFO 2025-02-09 20:07:23,019 autoreload 77531 124260873613440 Watching for file changes with StatReloader
ERROR 2025-02-09 20:07:41,586 log 77531 124260685186752 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 817, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: threat/ip_analysis.html
INFO 2025-02-09 20:09:26,575 autoreload 77531 124260873613440 /home/Agile/code/stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-09 20:09:26,947 autoreload 78155 129096385360000 Watching for file changes with StatReloader
ERROR 2025-02-09 20:11:02,599 log 78155 129096245839552 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 817, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: threat/ip_analysis.html
INFO 2025-02-09 20:12:00,765 autoreload 78155 129096385360000 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 20:12:01,164 autoreload 78847 135445728145536 Watching for file changes with StatReloader
INFO 2025-02-09 20:12:24,942 ip_analysis 78847 135445648246464 Cache is available
ERROR 2025-02-09 20:12:25,006 base_scanner 78847 135445648246464 greynoise API error: 429
ERROR 2025-02-09 20:12:25,122 base_scanner 78847 135445648246464 ipinfo API error: 403
ERROR 2025-02-09 20:12:25,154 base_scanner 78847 135445648246464 ipinfo API error: 403
ERROR 2025-02-09 20:12:25,455 base_scanner 78847 135445648246464 crowdsec API error: 403
ERROR 2025-02-09 20:12:25,749 base_scanner 78847 135445648246464 metadefender API error: 404
ERROR 2025-02-09 20:12:26,973 base_scanner 78847 135445648246464 securitytrails API error: 400
ERROR 2025-02-09 20:13:31,784 views 78847 135445648246464 Error analyzing IP: 'coordinates'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 832, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 145, in analyze_ip
    network_data.append(scanner.extract_network_info(data))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py", line 140, in extract_network_info
    network_info["network"]["coordinates"].update({
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'coordinates'
ERROR 2025-02-09 20:13:31,787 log 78847 135445648246464 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
INFO 2025-02-09 20:47:00,267 ip_analysis 78847 135445327382208 Cache is available
ERROR 2025-02-09 20:47:00,419 base_scanner 78847 135445327382208 greynoise API error: 429
ERROR 2025-02-09 20:47:00,531 base_scanner 78847 135445327382208 ipinfo API error: 403
ERROR 2025-02-09 20:47:00,562 base_scanner 78847 135445327382208 ipinfo API error: 403
ERROR 2025-02-09 20:47:00,788 base_scanner 78847 135445327382208 metadefender API error: 404
ERROR 2025-02-09 20:47:00,801 base_scanner 78847 135445327382208 crowdsec API error: 403
ERROR 2025-02-09 20:47:01,943 base_scanner 78847 135445327382208 securitytrails API error: 400
INFO 2025-02-09 20:47:09,733 autoreload 87185 138105790718080 Watching for file changes with StatReloader
INFO 2025-02-09 20:51:56,536 autoreload 87185 138105790718080 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 20:51:56,929 autoreload 88416 138435939729536 Watching for file changes with StatReloader
INFO 2025-02-09 20:53:30,116 autoreload 88416 138435939729536 /home/Agile/code/stack/main/services/ip_scan/platforms/base_scanner.py changed, reloading.
INFO 2025-02-09 20:53:30,486 autoreload 88761 132618749218944 Watching for file changes with StatReloader
INFO 2025-02-09 20:54:00,157 autoreload 88761 132618749218944 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 20:54:00,553 autoreload 88833 135439720312960 Watching for file changes with StatReloader
INFO 2025-02-09 20:54:47,371 autoreload 88833 135439720312960 /home/Agile/code/stack/main/services/ip_scan/platforms/greynoise.py changed, reloading.
INFO 2025-02-09 20:54:47,825 autoreload 88919 128011116593280 Watching for file changes with StatReloader
INFO 2025-02-09 20:55:33,665 autoreload 88919 128011116593280 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 20:55:34,045 autoreload 89002 139890353926272 Watching for file changes with StatReloader
INFO 2025-02-09 20:56:24,893 autoreload 89002 139890353926272 /home/Agile/code/stack/main/services/ip_scan/platforms/securitytrails.py changed, reloading.
INFO 2025-02-09 20:56:25,473 autoreload 89094 125193437352064 Watching for file changes with StatReloader
INFO 2025-02-09 20:59:47,479 ip_analysis 89094 125193357887168 Cache is available
WARNING 2025-02-09 20:59:47,539 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 20:59:48,962 base_scanner 89094 125193357887168 metadefender resource not found: https://api.metadefender.com/v4/ip/78.142.18.219/geo
ERROR 2025-02-09 20:59:49,470 base_scanner 89094 125193357887168 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 20:59:49,612 base_scanner 89094 125193357887168 ipinfo API authentication error. Check API key.
ERROR 2025-02-09 20:59:50,681 base_scanner 89094 125193357887168 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 20:59:51,644 base_scanner 89094 125193357887168 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 20:59:52,547 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 20:59:52,710 base_scanner 89094 125193357887168 securitytrails resource not found: https://api.securitytrails.com/v1/ips/stats/78.142.18.219
WARNING 2025-02-09 20:59:54,216 base_scanner 89094 125193357887168 securitytrails resource not found: https://api.securitytrails.com/v1/ips/78.142.18.219/domains
WARNING 2025-02-09 20:59:57,555 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:02,564 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:07,575 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:12,587 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:17,599 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:22,607 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:27,619 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:32,624 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:37,633 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:42,646 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:47,657 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:52,666 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:00:57,677 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:01:02,690 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
WARNING 2025-02-09 21:01:07,697 base_scanner 89094 125193357887168 greynoise rate limit hit, waiting 5 seconds
INFO 2025-02-09 21:02:05,077 autoreload 89909 139648588120192 Watching for file changes with StatReloader
INFO 2025-02-09 21:02:59,014 autoreload 89909 139648588120192 /home/Agile/code/stack/main/services/ip_scan/platforms/greynoise.py changed, reloading.
INFO 2025-02-09 21:02:59,422 autoreload 90060 138836213735552 Watching for file changes with StatReloader
INFO 2025-02-09 21:03:04,894 ip_analysis 90060 138836145342144 Cache is available
WARNING 2025-02-09 21:03:06,353 base_scanner 90060 138836145342144 metadefender resource not found: https://api.metadefender.com/v4/ip/78.142.18.219/geo
ERROR 2025-02-09 21:03:06,716 base_scanner 90060 138836145342144 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 21:03:07,081 base_scanner 90060 138836145342144 ipinfo API authentication error. Check API key.
ERROR 2025-02-09 21:03:07,790 base_scanner 90060 138836145342144 crowdsec API authentication error. Check API key.
WARNING 2025-02-09 21:03:09,049 base_scanner 90060 138836145342144 securitytrails resource not found: https://api.securitytrails.com/v1/ips/stats/78.142.18.219
ERROR 2025-02-09 21:03:09,112 base_scanner 90060 138836145342144 ipinfo API authentication error. Check API key.
INFO 2025-02-09 21:03:09,395 ip_analysis 90060 138835981764288 Cache is available
WARNING 2025-02-09 21:03:09,973 base_scanner 90060 138836145342144 greynoise resource not found: https://api.greynoise.io/v3/v2/noise/context/78.142.18.219
WARNING 2025-02-09 21:03:10,553 base_scanner 90060 138836145342144 securitytrails resource not found: https://api.securitytrails.com/v1/ips/78.142.18.219/domains
WARNING 2025-02-09 21:03:10,841 base_scanner 90060 138835981764288 metadefender resource not found: https://api.metadefender.com/v4/ip/78.142.18.219/geo
ERROR 2025-02-09 21:03:11,155 base_scanner 90060 138835981764288 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 21:03:11,524 base_scanner 90060 138835981764288 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 21:03:11,837 base_scanner 90060 138835981764288 securitytrails resource not found: https://api.securitytrails.com/v1/ips/stats/78.142.18.219
ERROR 2025-02-09 21:03:12,231 base_scanner 90060 138835981764288 crowdsec API authentication error. Check API key.
WARNING 2025-02-09 21:03:13,342 base_scanner 90060 138835981764288 securitytrails resource not found: https://api.securitytrails.com/v1/ips/78.142.18.219/domains
ERROR 2025-02-09 21:03:13,558 base_scanner 90060 138835981764288 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 21:03:14,443 base_scanner 90060 138835981764288 greynoise resource not found: https://api.greynoise.io/v3/v2/noise/context/78.142.18.219
WARNING 2025-02-09 21:03:14,979 base_scanner 90060 138836145342144 greynoise resource not found: https://api.greynoise.io/v3/v2/noise/quick/78.142.18.219
ERROR 2025-02-09 21:03:15,686 views 90060 138836145342144 Error analyzing IP: object of type 'int' has no len()
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 832, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 139, in analyze_ip
    score = scanner.calculate_score(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/platforms/metadefender.py", line 63, in calculate_score
    score += len(detected_by) * 15  # 15 points per detection
             ^^^^^^^^^^^^^^^^
TypeError: object of type 'int' has no len()
ERROR 2025-02-09 21:03:15,690 log 90060 138836145342144 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
WARNING 2025-02-09 21:03:19,448 base_scanner 90060 138835981764288 greynoise resource not found: https://api.greynoise.io/v3/v2/noise/quick/78.142.18.219
ERROR 2025-02-09 21:03:20,717 views 90060 138835981764288 Error analyzing IP: object of type 'int' has no len()
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 832, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 139, in analyze_ip
    score = scanner.calculate_score(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/platforms/metadefender.py", line 63, in calculate_score
    score += len(detected_by) * 15  # 15 points per detection
             ^^^^^^^^^^^^^^^^
TypeError: object of type 'int' has no len()
ERROR 2025-02-09 21:03:20,721 log 90060 138835981764288 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
INFO 2025-02-09 21:13:46,491 autoreload 90060 138836213735552 /home/Agile/code/stack/main/services/ip_scan/platforms/metadefender.py changed, reloading.
INFO 2025-02-09 21:13:46,859 autoreload 90636 131420265140352 Watching for file changes with StatReloader
INFO 2025-02-09 21:14:45,795 autoreload 90636 131420265140352 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 21:14:46,177 autoreload 90709 124103770067072 Watching for file changes with StatReloader
INFO 2025-02-09 21:15:42,106 autoreload 90709 124103770067072 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 21:15:42,478 autoreload 90809 129129240207488 Watching for file changes with StatReloader
INFO 2025-02-09 21:16:42,391 autoreload 90809 129129240207488 /home/Agile/code/stack/main/services/ip_scan/platforms/securitytrails.py changed, reloading.
INFO 2025-02-09 21:16:42,747 autoreload 90885 124416381079680 Watching for file changes with StatReloader
INFO 2025-02-09 21:17:32,557 autoreload 90885 124416381079680 /home/Agile/code/stack/main/services/ip_scan/platforms/greynoise.py changed, reloading.
INFO 2025-02-09 21:17:32,942 autoreload 90967 128033214738560 Watching for file changes with StatReloader
INFO 2025-02-09 21:17:53,524 autoreload 90967 128033214738560 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 21:17:53,892 autoreload 91021 129390988537984 Watching for file changes with StatReloader
INFO 2025-02-09 21:18:17,919 ip_analysis 91021 129390851655360 Cache is available
WARNING 2025-02-09 21:18:18,044 base_scanner 91021 129390851655360 securitytrails resource not found: https://api.securitytrails.com/v1/ips/78.142.18.219
ERROR 2025-02-09 21:18:18,438 base_scanner 91021 129390851655360 crowdsec API authentication error. Check API key.
WARNING 2025-02-09 21:18:19,425 base_scanner 91021 129390851655360 metadefender resource not found: https://api.metadefender.com/v4/ip/78.142.18.219/geo
ERROR 2025-02-09 21:18:20,102 base_scanner 91021 129390851655360 ipinfo API authentication error. Check API key.
ERROR 2025-02-09 21:18:22,157 base_scanner 91021 129390851655360 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 21:18:23,079 base_scanner 91021 129390851655360 greynoise resource not found: https://api.greynoise.io/v3/community/quick/78.142.18.219
ERROR 2025-02-09 21:19:01,743 views 91021 129390851655360 Error analyzing IP: unsupported operand type(s) for *: 'NoneType' and 'int'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 832, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 139, in analyze_ip
    score = scanner.calculate_score(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/platforms/alienvault.py", line 73, in calculate_score
    score += reputation_score * 10  # Reputation is 0-10, multiply by 10
             ~~~~~~~~~~~~~~~~~^~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'int'
ERROR 2025-02-09 21:19:01,746 log 91021 129390851655360 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
INFO 2025-02-09 22:04:05,923 autoreload 93274 136422822772864 Watching for file changes with StatReloader
INFO 2025-02-09 22:04:12,759 ip_analysis 93274 136422753306304 Cache is available
WARNING 2025-02-09 22:04:12,843 base_scanner 93274 136422753306304 securitytrails resource not found: https://api.securitytrails.com/v1/ips/185.220.101.70
ERROR 2025-02-09 22:04:13,139 base_scanner 93274 136422753306304 crowdsec API authentication error. Check API key.
WARNING 2025-02-09 22:04:14,241 base_scanner 93274 136422753306304 metadefender resource not found: https://api.metadefender.com/v4/ip/185.220.101.70/geo
ERROR 2025-02-09 22:04:14,889 base_scanner 93274 136422753306304 ipinfo API authentication error. Check API key.
ERROR 2025-02-09 22:04:16,924 base_scanner 93274 136422753306304 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 22:04:17,934 base_scanner 93274 136422753306304 greynoise resource not found: https://api.greynoise.io/v3/community/quick/185.220.101.70
ERROR 2025-02-09 22:04:48,888 views 93274 136422753306304 Error analyzing IP: unsupported operand type(s) for *: 'NoneType' and 'int'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 832, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 139, in analyze_ip
    score = scanner.calculate_score(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/platforms/alienvault.py", line 73, in calculate_score
    score += reputation_score * 10  # Reputation is 0-10, multiply by 10
             ~~~~~~~~~~~~~~~~~^~~~
TypeError: unsupported operand type(s) for *: 'NoneType' and 'int'
ERROR 2025-02-09 22:04:48,892 log 93274 136422753306304 Internal Server Error: /threat/ip-analysis/analyze/185.220.101.70/
INFO 2025-02-09 22:07:06,889 autoreload 93274 136422822772864 /home/Agile/code/stack/main/services/ip_scan/platforms/alienvault.py changed, reloading.
INFO 2025-02-09 22:07:07,293 autoreload 93555 130336346960000 Watching for file changes with StatReloader
INFO 2025-02-09 22:07:43,036 autoreload 93555 130336346960000 /home/Agile/code/stack/main/services/ip_scan/platforms/securitytrails.py changed, reloading.
INFO 2025-02-09 22:07:43,428 autoreload 93630 131495933046912 Watching for file changes with StatReloader
INFO 2025-02-09 22:08:12,147 autoreload 93630 131495933046912 /home/Agile/code/stack/main/services/ip_scan/platforms/metadefender.py changed, reloading.
INFO 2025-02-09 22:08:12,521 autoreload 93695 125027042095232 Watching for file changes with StatReloader
INFO 2025-02-09 22:08:39,169 autoreload 93695 125027042095232 /home/Agile/code/stack/main/services/ip_scan/platforms/greynoise.py changed, reloading.
INFO 2025-02-09 22:08:39,601 autoreload 93761 130190073172096 Watching for file changes with StatReloader
INFO 2025-02-09 22:09:10,283 autoreload 93761 130190073172096 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 22:09:10,680 autoreload 93833 139748310298752 Watching for file changes with StatReloader
INFO 2025-02-09 22:09:43,369 autoreload 93833 139748310298752 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 22:09:43,730 autoreload 93900 136039031312512 Watching for file changes with StatReloader
INFO 2025-02-09 22:10:45,681 autoreload 93900 136039031312512 /home/Agile/code/stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-09 22:10:46,067 autoreload 93994 138071177941120 Watching for file changes with StatReloader
INFO 2025-02-09 22:11:44,989 autoreload 93994 138071177941120 /home/Agile/code/stack/main/services/ip_scan/utils/platform_scoring.py changed, reloading.
INFO 2025-02-09 22:11:45,409 autoreload 94088 136284314497152 Watching for file changes with StatReloader
ERROR 2025-02-09 22:12:31,791 views 94088 136284244805312 Error analyzing IP: 'IPAnalysisService' object does not support the asynchronous context manager protocol
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 831, in analyze_ip_api
    async with IPAnalysisService(request.user) as service:
TypeError: 'IPAnalysisService' object does not support the asynchronous context manager protocol
ERROR 2025-02-09 22:12:31,792 log 94088 136284244805312 Internal Server Error: /threat/ip-analysis/analyze/185.220.101.70/
INFO 2025-02-09 22:13:39,862 autoreload 94088 136284314497152 /home/Agile/code/stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-09 22:13:40,275 autoreload 94261 132563905597568 Watching for file changes with StatReloader
INFO 2025-02-09 22:14:30,139 autoreload 94261 132563905597568 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 22:14:30,521 autoreload 94348 134112758132864 Watching for file changes with StatReloader
INFO 2025-02-09 22:15:15,337 autoreload 94348 134112758132864 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 22:15:15,704 autoreload 94426 137821634789504 Watching for file changes with StatReloader
INFO 2025-02-09 22:15:36,238 autoreload 94495 140102267334784 Watching for file changes with StatReloader
INFO 2025-02-09 22:17:37,079 autoreload 94797 125981807177856 Watching for file changes with StatReloader
ERROR 2025-02-09 22:17:56,845 log 94797 125981614409408 Internal Server Error: /threat/ip-analysis/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/auth/decorators.py", line 60, in _view_wrapper
    return view_func(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/views.py", line 821, in ip_analysis
    return render(request, 'threat/ip_analysis.html')
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/shortcuts.py", line 25, in render
    content = loader.render_to_string(template_name, context, request, using=using)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 61, in render_to_string
    template = get_template(template_name, using=using)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/template/loader.py", line 19, in get_template
    raise TemplateDoesNotExist(template_name, chain=chain)
django.template.exceptions.TemplateDoesNotExist: threat/ip_analysis.html
INFO 2025-02-09 22:20:46,166 autoreload 94797 125981807177856 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 22:20:46,559 autoreload 95075 136777854255232 Watching for file changes with StatReloader
ERROR 2025-02-09 22:21:12,659 ip_analysis 95075 136777784362688 Error retrieving API keys: 'APIKey' object has no attribute 'key'
ERROR 2025-02-09 22:21:12,660 ip_analysis 95075 136777784362688 Error retrieving API keys: 'APIKey' object has no attribute 'key'
INFO 2025-02-09 22:24:29,978 autoreload 95075 136777854255232 /home/Agile/code/stack/main/models.py changed, reloading.
INFO 2025-02-09 22:24:30,393 autoreload 95351 136556925087872 Watching for file changes with StatReloader
INFO 2025-02-09 22:33:43,959 autoreload 96045 131502779797632 Watching for file changes with StatReloader
ERROR 2025-02-09 22:38:29,112 views 96045 131502469809856 Error analyzing IP: Can't instantiate abstract class MetaDefenderScanner without an implementation for abstract methods 'extract_network_info', 'extract_whois'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 835, in analyze_ip_api
    async with IPAnalysisService() as service:  # Removed request.user parameter
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 41, in __aenter__
    await self.initialize_scanners()
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 79, in initialize_scanners
    self.scanners[platform] = scanner_class(self.session, api_key)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Can't instantiate abstract class MetaDefenderScanner without an implementation for abstract methods 'extract_network_info', 'extract_whois'
ERROR 2025-02-09 22:38:29,113 base_events 96045 131502469809856 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7799dc69ba70>
ERROR 2025-02-09 22:38:29,114 log 96045 131502593541824 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
INFO 2025-02-09 22:41:10,808 autoreload 98063 129595763019904 Watching for file changes with StatReloader
INFO 2025-02-09 22:41:22,683 autoreload 98206 129625324490880 Watching for file changes with StatReloader
ERROR 2025-02-09 22:42:46,188 views 98206 129625088853696 Error analyzing IP: Can't instantiate abstract class MetaDefenderScanner without an implementation for abstract methods 'extract_network_info', 'extract_whois'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 835, in analyze_ip_api
    async with IPAnalysisService() as service:  # Removed request.user parameter
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 41, in __aenter__
    await self.initialize_scanners()
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 79, in initialize_scanners
    self.scanners[platform] = scanner_class(self.session, api_key)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Can't instantiate abstract class MetaDefenderScanner without an implementation for abstract methods 'extract_network_info', 'extract_whois'
ERROR 2025-02-09 22:42:46,189 base_events 98206 129625088853696 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x75e4bb5865a0>
ERROR 2025-02-09 22:42:46,190 log 98206 129625099339456 Internal Server Error: /threat/ip-analysis/analyze/78.142.18.219/
INFO 2025-02-09 22:44:59,083 autoreload 98206 129625324490880 /home/Agile/code/stack/main/services/ip_scan/platforms/metadefender.py changed, reloading.
INFO 2025-02-09 22:44:59,493 autoreload 99263 124991538757760 Watching for file changes with StatReloader
INFO 2025-02-09 22:45:23,155 autoreload 99263 124991538757760 /home/Agile/code/stack/main/views.py changed, reloading.
INFO 2025-02-09 22:45:23,529 autoreload 99395 128628854915200 Watching for file changes with StatReloader
WARNING 2025-02-09 22:46:38,319 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:38,389 base_scanner 99395 128628687898304 securitytrails resource not found: https://api.securitytrails.com/v1/ips/185.220.101.70
ERROR 2025-02-09 22:46:38,785 base_scanner 99395 128628687898304 crowdsec API authentication error. Check API key.
WARNING 2025-02-09 22:46:39,327 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
ERROR 2025-02-09 22:46:39,457 base_scanner 99395 128628687898304 ipinfo API authentication error. Check API key.
WARNING 2025-02-09 22:46:40,335 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:41,344 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:42,350 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:43,358 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:44,366 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:45,374 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:46,384 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:47,392 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:48,398 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:49,406 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:50,414 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:51,420 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:52,428 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
WARNING 2025-02-09 22:46:53,436 base_scanner 99395 128628687898304 greynoise rate limit hit, waiting 1 seconds
INFO 2025-02-09 22:50:47,562 autoreload 100846 130619646378112 Watching for file changes with StatReloader
ERROR 2025-02-09 22:50:55,877 ip_analysis 100846 130619577206464 Error retrieving API keys: 'APIKey' object has no attribute 'get_decrypted_api_key'
ERROR 2025-02-09 22:50:55,878 ip_analysis 100846 130619577206464 Error retrieving API keys: 'APIKey' object has no attribute 'get_decrypted_api_key'
INFO 2025-02-09 22:51:43,543 autoreload 100846 130619646378112 /home/Agile/code/stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-09 22:51:44,003 autoreload 101128 137536525684864 Watching for file changes with StatReloader
INFO 2025-02-09 22:51:49,518 autoreload 101128 137536525684864 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 22:51:49,950 autoreload 101186 124083527901312 Watching for file changes with StatReloader
INFO 2025-02-09 22:52:13,030 ip_analysis 101186 124083347916480 Cache hit for IP 185.220.101.70
ERROR 2025-02-09 22:52:47,693 base_scanner 101186 124083337430720 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 22:52:48,379 base_scanner 101186 124083337430720 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:01:13,156 autoreload 104184 124711692398720 Watching for file changes with StatReloader
INFO 2025-02-09 23:01:27,660 ip_analysis 104184 124711553992384 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:01:27,661 ip_analysis 104184 124711553992384 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:01:27,661 ip_analysis 104184 124711553992384 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:01:27,661 ip_analysis 104184 124711553992384 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:01:27,661 ip_analysis 104184 124711553992384 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:01:27,662 ip_analysis 104184 124711553992384 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:01:27,662 ip_analysis 104184 124711553992384 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:01:27,662 ip_analysis 104184 124711553992384 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:01:27,662 ip_analysis 104184 124711553992384 Retrieved key for platform filescan: success
INFO 2025-02-09 23:01:27,662 ip_analysis 104184 124711553992384 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:01:27,663 ip_analysis 104184 124711553992384 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:01:27,663 ip_analysis 104184 124711553992384 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:01:27,663 ip_analysis 104184 124711553992384 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:01:27,663 ip_analysis 104184 124711553992384 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:01:27,663 ip_analysis 104184 124711553992384 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:01:27,664 ip_analysis 104184 124711553992384 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:01:27,664 ip_analysis 104184 124711553992384 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:01:27,664 ip_analysis 104184 124711553992384 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:01:27,664 ip_analysis 104184 124711553992384 Retrieved 18 valid API keys
ERROR 2025-02-09 23:01:27,869 base_scanner 104184 124711522535104 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 23:01:28,785 base_scanner 104184 124711522535104 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:02:53,534 autoreload 104184 124711692398720 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:02:53,926 autoreload 104677 133217268093056 Watching for file changes with StatReloader
INFO 2025-02-09 23:03:04,468 autoreload 104677 133217268093056 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:03:05,181 autoreload 104766 133018199015552 Watching for file changes with StatReloader
INFO 2025-02-09 23:03:27,246 ip_analysis 104766 133018129794752 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:03:27,246 ip_analysis 104766 133018129794752 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:03:27,246 ip_analysis 104766 133018129794752 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:03:27,247 ip_analysis 104766 133018129794752 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:03:27,247 ip_analysis 104766 133018129794752 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:03:27,247 ip_analysis 104766 133018129794752 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:03:27,247 ip_analysis 104766 133018129794752 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:03:27,247 ip_analysis 104766 133018129794752 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform filescan: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:03:27,248 ip_analysis 104766 133018129794752 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:03:27,249 ip_analysis 104766 133018129794752 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:03:27,249 ip_analysis 104766 133018129794752 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:03:27,249 ip_analysis 104766 133018129794752 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:03:27,249 ip_analysis 104766 133018129794752 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:03:27,249 ip_analysis 104766 133018129794752 Retrieved 18 valid API keys
ERROR 2025-02-09 23:03:27,685 base_scanner 104766 133018010257088 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 23:03:28,414 base_scanner 104766 133018010257088 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:04:14,110 autoreload 105171 129444778586240 Watching for file changes with StatReloader
INFO 2025-02-09 23:04:31,183 ip_analysis 105171 129444708615872 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:04:31,183 ip_analysis 105171 129444708615872 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:04:31,183 ip_analysis 105171 129444708615872 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:04:31,184 ip_analysis 105171 129444708615872 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:04:31,184 ip_analysis 105171 129444708615872 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:04:31,184 ip_analysis 105171 129444708615872 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:04:31,184 ip_analysis 105171 129444708615872 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:04:31,184 ip_analysis 105171 129444708615872 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform filescan: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:04:31,185 ip_analysis 105171 129444708615872 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:04:31,186 ip_analysis 105171 129444708615872 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:04:31,186 ip_analysis 105171 129444708615872 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:04:31,186 ip_analysis 105171 129444708615872 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:04:31,186 ip_analysis 105171 129444708615872 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:04:31,186 ip_analysis 105171 129444708615872 Retrieved 18 valid API keys
ERROR 2025-02-09 23:04:31,571 base_scanner 105171 129444586981056 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 23:04:32,305 base_scanner 105171 129444586981056 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:05:55,497 autoreload 105171 129444778586240 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:05:55,954 autoreload 105741 136034770280576 Watching for file changes with StatReloader
INFO 2025-02-09 23:06:04,487 autoreload 105741 136034770280576 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:06:04,919 autoreload 105840 137042153271424 Watching for file changes with StatReloader
INFO 2025-02-09 23:06:29,358 ip_analysis 105840 137042084234944 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:06:29,358 ip_analysis 105840 137042084234944 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:06:29,359 ip_analysis 105840 137042084234944 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:06:29,359 ip_analysis 105840 137042084234944 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:06:29,359 ip_analysis 105840 137042084234944 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:06:29,359 ip_analysis 105840 137042084234944 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:06:29,360 ip_analysis 105840 137042084234944 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:06:29,360 ip_analysis 105840 137042084234944 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:06:29,360 ip_analysis 105840 137042084234944 Retrieved key for platform filescan: success
INFO 2025-02-09 23:06:29,360 ip_analysis 105840 137042084234944 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:06:29,361 ip_analysis 105840 137042084234944 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:06:29,361 ip_analysis 105840 137042084234944 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:06:29,361 ip_analysis 105840 137042084234944 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:06:29,361 ip_analysis 105840 137042084234944 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:06:29,362 ip_analysis 105840 137042084234944 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:06:29,362 ip_analysis 105840 137042084234944 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:06:29,362 ip_analysis 105840 137042084234944 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:06:29,362 ip_analysis 105840 137042084234944 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:06:29,362 ip_analysis 105840 137042084234944 Retrieved 18 valid API keys
INFO 2025-02-09 23:06:29,366 ip_analysis 105840 137041960502976 Cache hit for IP 185.220.101.110
INFO 2025-02-09 23:06:52,328 ip_analysis 105840 137042084234944 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:06:52,328 ip_analysis 105840 137042084234944 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:06:52,329 ip_analysis 105840 137042084234944 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:06:52,329 ip_analysis 105840 137042084234944 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:06:52,329 ip_analysis 105840 137042084234944 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:06:52,329 ip_analysis 105840 137042084234944 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:06:52,330 ip_analysis 105840 137042084234944 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:06:52,330 ip_analysis 105840 137042084234944 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:06:52,330 ip_analysis 105840 137042084234944 Retrieved key for platform filescan: success
INFO 2025-02-09 23:06:52,330 ip_analysis 105840 137042084234944 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:06:52,331 ip_analysis 105840 137042084234944 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:06:52,331 ip_analysis 105840 137042084234944 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:06:52,331 ip_analysis 105840 137042084234944 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:06:52,331 ip_analysis 105840 137042084234944 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:06:52,332 ip_analysis 105840 137042084234944 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:06:52,332 ip_analysis 105840 137042084234944 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:06:52,332 ip_analysis 105840 137042084234944 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:06:52,332 ip_analysis 105840 137042084234944 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:06:52,332 ip_analysis 105840 137042084234944 Retrieved 18 valid API keys
ERROR 2025-02-09 23:06:52,582 base_scanner 105840 137041981474496 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 23:06:53,445 base_scanner 105840 137041981474496 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:07:29,491 ip_analysis 105840 137041769662144 Retrieved key for platform virustotal: success
INFO 2025-02-09 23:07:29,491 ip_analysis 105840 137041769662144 Retrieved key for platform abuseipdb: success
INFO 2025-02-09 23:07:29,491 ip_analysis 105840 137041769662144 Retrieved key for platform alienvault: success
INFO 2025-02-09 23:07:29,492 ip_analysis 105840 137041769662144 Retrieved key for platform ibm_xforce: success
INFO 2025-02-09 23:07:29,492 ip_analysis 105840 137041769662144 Retrieved key for platform urlscan: success
INFO 2025-02-09 23:07:29,492 ip_analysis 105840 137041769662144 Retrieved key for platform securitytrails: success
INFO 2025-02-09 23:07:29,492 ip_analysis 105840 137041769662144 Retrieved key for platform hybrid_analysis: success
INFO 2025-02-09 23:07:29,492 ip_analysis 105840 137041769662144 Retrieved key for platform pulsedive: success
INFO 2025-02-09 23:07:29,493 ip_analysis 105840 137041769662144 Retrieved key for platform filescan: success
INFO 2025-02-09 23:07:29,493 ip_analysis 105840 137041769662144 Retrieved key for platform malwarebazaar: success
INFO 2025-02-09 23:07:29,493 ip_analysis 105840 137041769662144 Retrieved key for platform threatfox: success
INFO 2025-02-09 23:07:29,493 ip_analysis 105840 137041769662144 Retrieved key for platform urlhaus: success
INFO 2025-02-09 23:07:29,494 ip_analysis 105840 137041769662144 Retrieved key for platform spamhaus: success
INFO 2025-02-09 23:07:29,494 ip_analysis 105840 137041769662144 Retrieved key for platform cloudmersive: success
INFO 2025-02-09 23:07:29,494 ip_analysis 105840 137041769662144 Retrieved key for platform metadefender: success
INFO 2025-02-09 23:07:29,494 ip_analysis 105840 137041769662144 Retrieved key for platform greynoise: success
INFO 2025-02-09 23:07:29,494 ip_analysis 105840 137041769662144 Retrieved key for platform crowdsec: success
INFO 2025-02-09 23:07:29,495 ip_analysis 105840 137041769662144 Retrieved key for platform ipinfo: success
INFO 2025-02-09 23:07:29,495 ip_analysis 105840 137041769662144 Retrieved 18 valid API keys
ERROR 2025-02-09 23:07:29,788 base_scanner 105840 137042084234944 crowdsec API authentication error. Check API key.
ERROR 2025-02-09 23:07:30,604 base_scanner 105840 137042084234944 ipinfo API authentication error. Check API key.
INFO 2025-02-09 23:08:15,494 autoreload 105840 137042153271424 /home/Agile/code/stack/main/services/ip_scan/ip_analysis.py changed, reloading.
INFO 2025-02-09 23:08:21,548 autoreload 106837 133203397685376 Watching for file changes with StatReloader
INFO 2025-02-09 23:08:26,044 autoreload 106837 133203397685376 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:08:26,440 autoreload 106878 127281737994368 Watching for file changes with StatReloader
INFO 2025-02-09 23:08:35,966 autoreload 106878 127281737994368 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:08:36,459 autoreload 106960 127760335868032 Watching for file changes with StatReloader
INFO 2025-02-09 23:09:06,138 autoreload 106960 127760335868032 /home/Agile/code/stack/main/services/ip_scan/platforms/base_scanner.py changed, reloading.
INFO 2025-02-09 23:09:06,535 autoreload 107103 133563484336256 Watching for file changes with StatReloader
INFO 2025-02-09 23:09:38,990 ip_analysis 107103 133563336885952 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:09:38,991 ip_analysis 107103 133563336885952 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:09:38,991 ip_analysis 107103 133563336885952 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:09:38,991 ip_analysis 107103 133563336885952 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:09:38,992 ip_analysis 107103 133563336885952 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:09:38,992 ip_analysis 107103 133563336885952 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:09:38,992 ip_analysis 107103 133563336885952 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:09:38,992 ip_analysis 107103 133563336885952 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:09:38,993 ip_analysis 107103 133563336885952 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:09:38,993 ip_analysis 107103 133563336885952 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:09:38,993 ip_analysis 107103 133563336885952 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:09:38,993 ip_analysis 107103 133563336885952 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:09:38,993 ip_analysis 107103 133563336885952 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:09:38,994 ip_analysis 107103 133563336885952 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:09:38,994 ip_analysis 107103 133563336885952 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:09:38,994 ip_analysis 107103 133563336885952 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:09:38,994 ip_analysis 107103 133563336885952 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:09:38,995 ip_analysis 107103 133563336885952 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:09:38,995 ip_analysis 107103 133563336885952 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
ERROR 2025-02-09 23:09:38,997 ip_analysis 107103 133563213153984 Error scanning with crowdsec: 'CrowdSecScanner' object has no attribute 'logger'
ERROR 2025-02-09 23:09:38,998 ip_analysis 107103 133563213153984 Error scanning with ipinfo: 'IPInfoScanner' object has no attribute 'logger'
INFO 2025-02-09 23:10:40,262 ip_analysis 107103 133563336885952 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:10:40,263 ip_analysis 107103 133563336885952 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:10:40,263 ip_analysis 107103 133563336885952 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:10:40,263 ip_analysis 107103 133563336885952 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:10:40,264 ip_analysis 107103 133563336885952 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:10:40,264 ip_analysis 107103 133563336885952 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:10:40,264 ip_analysis 107103 133563336885952 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:10:40,264 ip_analysis 107103 133563336885952 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:10:40,265 ip_analysis 107103 133563336885952 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:10:40,265 ip_analysis 107103 133563336885952 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:10:40,265 ip_analysis 107103 133563336885952 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:10:40,265 ip_analysis 107103 133563336885952 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:10:40,265 ip_analysis 107103 133563336885952 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:10:40,266 ip_analysis 107103 133563336885952 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:10:40,266 ip_analysis 107103 133563336885952 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:10:40,266 ip_analysis 107103 133563336885952 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:10:40,266 ip_analysis 107103 133563336885952 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:10:40,266 ip_analysis 107103 133563336885952 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:10:40,267 ip_analysis 107103 133563336885952 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
ERROR 2025-02-09 23:10:40,269 ip_analysis 107103 133563181696704 Error scanning with crowdsec: 'CrowdSecScanner' object has no attribute 'logger'
ERROR 2025-02-09 23:10:40,269 ip_analysis 107103 133563181696704 Error scanning with ipinfo: 'IPInfoScanner' object has no attribute 'logger'
INFO 2025-02-09 23:11:19,237 autoreload 107103 133563484336256 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:11:19,665 autoreload 107826 129915155779712 Watching for file changes with StatReloader
INFO 2025-02-09 23:11:25,144 autoreload 107826 129915155779712 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:11:25,522 autoreload 107871 133916679196800 Watching for file changes with StatReloader
INFO 2025-02-09 23:12:08,200 autoreload 107871 133916679196800 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:12:09,322 autoreload 108045 129393359999104 Watching for file changes with StatReloader
INFO 2025-02-09 23:13:01,917 autoreload 108414 139416427262080 Watching for file changes with StatReloader
INFO 2025-02-09 23:13:12,170 ip_analysis 108414 139416358094528 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:13:12,171 ip_analysis 108414 139416358094528 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:13:12,171 ip_analysis 108414 139416358094528 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:13:12,171 ip_analysis 108414 139416358094528 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:13:12,171 ip_analysis 108414 139416358094528 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:13:12,172 ip_analysis 108414 139416358094528 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:13:12,172 ip_analysis 108414 139416358094528 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:13:12,172 ip_analysis 108414 139416358094528 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:13:12,172 ip_analysis 108414 139416358094528 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:13:12,172 ip_analysis 108414 139416358094528 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:13:12,173 ip_analysis 108414 139416358094528 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:13:12,173 ip_analysis 108414 139416358094528 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:13:12,173 ip_analysis 108414 139416358094528 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:13:12,173 ip_analysis 108414 139416358094528 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:13:12,173 ip_analysis 108414 139416358094528 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:13:12,174 ip_analysis 108414 139416358094528 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:13:12,174 ip_analysis 108414 139416358094528 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:13:12,174 ip_analysis 108414 139416358094528 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:13:12,174 ip_analysis 108414 139416358094528 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
INFO 2025-02-09 23:13:12,176 ip_analysis 108414 139416236459712 Cache hit for IP 193.189.100.200
INFO 2025-02-09 23:13:38,055 ip_analysis 108414 139416358094528 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:13:38,055 ip_analysis 108414 139416358094528 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:13:38,055 ip_analysis 108414 139416358094528 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:13:38,056 ip_analysis 108414 139416358094528 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:13:38,056 ip_analysis 108414 139416358094528 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:13:38,056 ip_analysis 108414 139416358094528 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:13:38,056 ip_analysis 108414 139416358094528 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:13:38,057 ip_analysis 108414 139416358094528 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:13:38,057 ip_analysis 108414 139416358094528 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:13:38,057 ip_analysis 108414 139416358094528 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:13:38,057 ip_analysis 108414 139416358094528 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:13:38,057 ip_analysis 108414 139416358094528 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:13:38,058 ip_analysis 108414 139416358094528 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:13:38,058 ip_analysis 108414 139416358094528 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:13:38,058 ip_analysis 108414 139416358094528 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:13:38,058 ip_analysis 108414 139416358094528 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:13:38,059 ip_analysis 108414 139416358094528 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:13:38,059 ip_analysis 108414 139416358094528 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:13:38,059 ip_analysis 108414 139416358094528 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
INFO 2025-02-09 23:13:38,061 crowdsec 108414 139416246945472 CrowdSec request - URL: https://api.crowdsec.net/v2/smoke/71.197.106.204, Key Preview: f91b***
INFO 2025-02-09 23:13:38,062 ipinfo 108414 139416246945472 IPInfo request - URL: https://ipinfo.io/71.197.106.204/json?token=<hidden>, Key Preview: e94d***
WARNING 2025-02-09 23:13:38,094 base_scanner 108414 139416246945472 greynoise resource not found: https://api.greynoise.io/v3/community/71.197.106.204
WARNING 2025-02-09 23:13:38,140 base_scanner 108414 139416246945472 pulsedive resource not found: https://pulsedive.com/api/info.php
INFO 2025-02-09 23:13:38,142 ipinfo 108414 139416246945472 IPInfo basic info response: {'ip': '71.197.106.204', 'hostname': 'c-71-197-106-204.hsd1.ca.comcast.net', 'city': 'Folsom', 'region': 'California', 'country': 'US', 'loc': '38.6780,-121.1761', 'org': 'AS7922 Comcast Cable Communications, LLC', 'postal': '95763', 'timezone': 'America/Los_Angeles'}
INFO 2025-02-09 23:13:38,142 ipinfo 108414 139416246945472 IPInfo privacy request - URL: https://ipinfo.io/71.197.106.204/privacy?token=<hidden>
ERROR 2025-02-09 23:13:38,161 base_scanner 108414 139416246945472 crowdsec API authentication error. Status: 403, Response: {"message":"Missing Authentication Token"}

INFO 2025-02-09 23:13:38,161 crowdsec 108414 139416246945472 CrowdSec raw response: {'error': 'API authentication error. Check API key.', 'details': {'message': 'Missing Authentication Token'}}
ERROR 2025-02-09 23:13:39,175 base_scanner 108414 139416246945472 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-09 23:13:39,175 ipinfo 108414 139416246945472 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-09 23:15:06,454 autoreload 108414 139416427262080 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:15:06,886 autoreload 108990 133575348523136 Watching for file changes with StatReloader
INFO 2025-02-09 23:15:24,648 autoreload 108990 133575348523136 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-09 23:15:25,034 autoreload 109100 131868090323072 Watching for file changes with StatReloader
INFO 2025-02-09 23:16:09,073 ip_analysis 109100 131868022277824 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:16:09,074 ip_analysis 109100 131868022277824 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:16:09,074 ip_analysis 109100 131868022277824 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:16:09,074 ip_analysis 109100 131868022277824 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:16:09,074 ip_analysis 109100 131868022277824 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:16:09,075 ip_analysis 109100 131868022277824 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:16:09,075 ip_analysis 109100 131868022277824 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:16:09,075 ip_analysis 109100 131868022277824 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:16:09,075 ip_analysis 109100 131868022277824 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:16:09,076 ip_analysis 109100 131868022277824 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:16:09,076 ip_analysis 109100 131868022277824 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:16:09,076 ip_analysis 109100 131868022277824 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:16:09,076 ip_analysis 109100 131868022277824 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:16:09,076 ip_analysis 109100 131868022277824 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:16:09,077 ip_analysis 109100 131868022277824 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:16:09,077 ip_analysis 109100 131868022277824 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:16:09,077 ip_analysis 109100 131868022277824 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:16:09,077 ip_analysis 109100 131868022277824 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:16:09,078 ip_analysis 109100 131868022277824 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
INFO 2025-02-09 23:16:09,080 crowdsec 109100 131868001306304 CrowdSec request - URL: https://api.crowdsec.net/v2/smoke/2.58.56.35, Key Preview: f91b***
INFO 2025-02-09 23:16:09,081 ipinfo 109100 131868001306304 IPInfo request - URL: https://ipinfo.io/2.58.56.35/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-09 23:16:09,330 ipinfo 109100 131868001306304 IPInfo basic info response: {'ip': '2.58.56.35', 'hostname': 'amsterdam5.quetzalcoatl-relays.org', 'city': 'Amsterdam', 'region': 'North Holland', 'country': 'NL', 'loc': '52.3740,4.8897', 'org': 'AS210558 1337 Services GmbH', 'postal': '1012', 'timezone': 'Europe/Amsterdam'}
INFO 2025-02-09 23:16:09,331 ipinfo 109100 131868001306304 IPInfo privacy request - URL: https://ipinfo.io/2.58.56.35/privacy?token=<hidden>
ERROR 2025-02-09 23:16:09,417 base_scanner 109100 131868001306304 crowdsec API authentication error. Status: 403, Response: {"message":"Invalid key=value pair (missing equal-sign) in Authorization header (hashed with SHA-256 and encoded with Base64): 'kiJRv6hWt0/9TVF5xRnqSWDGhR82u68ufzzarCtTn5A='."}

INFO 2025-02-09 23:16:09,417 crowdsec 109100 131868001306304 CrowdSec raw response: {'error': 'API authentication error. Check API key.', 'details': {'message': "Invalid key=value pair (missing equal-sign) in Authorization header (hashed with SHA-256 and encoded with Base64): 'kiJRv6hWt0/9TVF5xRnqSWDGhR82u68ufzzarCtTn5A='."}}
ERROR 2025-02-09 23:16:10,368 base_scanner 109100 131868001306304 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-09 23:16:10,368 ipinfo 109100 131868001306304 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-09 23:17:42,742 autoreload 109100 131868090323072 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:17:43,262 autoreload 109679 134899733098624 Watching for file changes with StatReloader
INFO 2025-02-09 23:18:10,117 ip_analysis 109679 134899663111872 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:18:10,118 ip_analysis 109679 134899663111872 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:18:10,118 ip_analysis 109679 134899663111872 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:18:10,118 ip_analysis 109679 134899663111872 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:18:10,119 ip_analysis 109679 134899663111872 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:18:10,119 ip_analysis 109679 134899663111872 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:18:10,119 ip_analysis 109679 134899663111872 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:18:10,119 ip_analysis 109679 134899663111872 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:18:10,120 ip_analysis 109679 134899663111872 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:18:10,120 ip_analysis 109679 134899663111872 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:18:10,120 ip_analysis 109679 134899663111872 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:18:10,120 ip_analysis 109679 134899663111872 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:18:10,120 ip_analysis 109679 134899663111872 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:18:10,121 ip_analysis 109679 134899663111872 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:18:10,121 ip_analysis 109679 134899663111872 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:18:10,121 ip_analysis 109679 134899663111872 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:18:10,121 ip_analysis 109679 134899663111872 Retrieved key for platform crowdsec: success (preview: f91b***)
INFO 2025-02-09 23:18:10,122 ip_analysis 109679 134899663111872 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:18:10,122 ip_analysis 109679 134899663111872 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, crowdsec, ipinfo
INFO 2025-02-09 23:18:10,124 crowdsec 109679 134899652626112 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.220.100.253, Key Preview: f91b***
INFO 2025-02-09 23:18:10,125 ipinfo 109679 134899652626112 IPInfo request - URL: https://ipinfo.io/185.220.100.253/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-09 23:18:10,208 ipinfo 109679 134899652626112 IPInfo basic info response: {'ip': '185.220.100.253', 'hostname': 'tor-exit-2.zbau.f3netze.de', 'city': 'Erlangen', 'region': 'Bavaria', 'country': 'DE', 'loc': '49.5910,11.0078', 'org': 'AS205100 F3 Netze e.V.', 'postal': '91052', 'timezone': 'Europe/Berlin'}
INFO 2025-02-09 23:18:10,208 ipinfo 109679 134899652626112 IPInfo privacy request - URL: https://ipinfo.io/185.220.100.253/privacy?token=<hidden>
ERROR 2025-02-09 23:18:10,447 base_scanner 109679 134899652626112 crowdsec API authentication error. Status: 403, Response: {"message":"Forbidden"}

INFO 2025-02-09 23:18:10,448 crowdsec 109679 134899652626112 CrowdSec raw response: {'error': 'API authentication error. Check API key.', 'details': {'message': 'Forbidden'}}
ERROR 2025-02-09 23:18:11,238 base_scanner 109679 134899652626112 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-09 23:18:11,238 ipinfo 109679 134899652626112 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-09 23:20:00,981 autoreload 109679 134899733098624 /home/Agile/code/stack/main/services/ip_scan/platforms/crowdsec.py changed, reloading.
INFO 2025-02-09 23:20:01,420 autoreload 110336 125343668142208 Watching for file changes with StatReloader
INFO 2025-02-09 23:23:04,699 autoreload 110336 125343668142208 /home/Agile/code/stack/main/admin.py changed, reloading.
INFO 2025-02-09 23:23:05,134 autoreload 111278 131424134393984 Watching for file changes with StatReloader
ERROR 2025-02-09 23:23:15,136 log 111278 131424065685184 Internal Server Error: /admin/main/apikey/20/change/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 839, in get_form
    return modelform_factory(self.model, **defaults)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 654, in modelform_factory
    return type(form)(class_name, (form,), form_class_attrs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 312, in __new__
    fields = fields_for_model(
             ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 207, in fields_for_model
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 718, in wrapper
    return self.admin_site.admin_view(view)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/views/decorators/cache.py", line 80, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/sites.py", line 241, in inner
    return view(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1964, in change_view
    return self.changeform_view(request, object_id, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 48, in _wrapper
    return bound_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1820, in changeform_view
    return self._changeform_view(request, object_id, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1855, in _changeform_view
    ModelForm = self.get_form(
                ^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 841, in get_form
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field. Check fields/fieldsets/exclude attributes of class APIKeyAdmin.
ERROR 2025-02-09 23:23:40,318 log 111278 131424065685184 Internal Server Error: /admin/main/apikey/20/change/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 839, in get_form
    return modelform_factory(self.model, **defaults)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 654, in modelform_factory
    return type(form)(class_name, (form,), form_class_attrs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 312, in __new__
    fields = fields_for_model(
             ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 207, in fields_for_model
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 718, in wrapper
    return self.admin_site.admin_view(view)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/views/decorators/cache.py", line 80, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/sites.py", line 241, in inner
    return view(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1964, in change_view
    return self.changeform_view(request, object_id, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 48, in _wrapper
    return bound_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1820, in changeform_view
    return self._changeform_view(request, object_id, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1855, in _changeform_view
    ModelForm = self.get_form(
                ^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 841, in get_form
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field. Check fields/fieldsets/exclude attributes of class APIKeyAdmin.
ERROR 2025-02-09 23:24:06,604 log 111278 131423941953216 Internal Server Error: /admin/main/apikey/add/
Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 839, in get_form
    return modelform_factory(self.model, **defaults)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 654, in modelform_factory
    return type(form)(class_name, (form,), form_class_attrs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 312, in __new__
    fields = fields_for_model(
             ^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/forms/models.py", line 207, in fields_for_model
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/exception.py", line 55, in inner
    response = get_response(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/core/handlers/base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 718, in wrapper
    return self.admin_site.admin_view(view)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/views/decorators/cache.py", line 80, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/sites.py", line 241, in inner
    return view(request, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1961, in add_view
    return self.changeform_view(request, None, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 48, in _wrapper
    return bound_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 188, in _view_wrapper
    result = _process_exception(request, e)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/utils/decorators.py", line 186, in _view_wrapper
    response = view_func(request, *args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1820, in changeform_view
    return self._changeform_view(request, object_id, form_url, extra_context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 1855, in _changeform_view
    ModelForm = self.get_form(
                ^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/venv/lib/python3.12/site-packages/django/contrib/admin/options.py", line 841, in get_form
    raise FieldError(
django.core.exceptions.FieldError: 'encrypted_api_key' cannot be specified for APIKey model form as it is a non-editable field. Check fields/fieldsets/exclude attributes of class APIKeyAdmin.
INFO 2025-02-09 23:25:05,993 ip_analysis 111278 131423941953216 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:25:05,993 ip_analysis 111278 131423941953216 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:25:05,993 ip_analysis 111278 131423941953216 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:25:05,994 ip_analysis 111278 131423941953216 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:25:05,994 ip_analysis 111278 131423941953216 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:25:05,994 ip_analysis 111278 131423941953216 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:25:05,994 ip_analysis 111278 131423941953216 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:25:05,994 ip_analysis 111278 131423941953216 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:25:05,995 ip_analysis 111278 131423941953216 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:25:05,996 ip_analysis 111278 131423941953216 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:25:05,996 ip_analysis 111278 131423941953216 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:25:05,996 ip_analysis 111278 131423941953216 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:25:05,996 ip_analysis 111278 131423941953216 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-09 23:25:05,996 ip_analysis 111278 131423941953216 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-09 23:25:05,999 crowdsec 111278 131423983896256 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.40.4.100, Key Preview: QXRr***
INFO 2025-02-09 23:25:06,000 ipinfo 111278 131423983896256 IPInfo request - URL: https://ipinfo.io/185.40.4.100/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-09 23:25:06,080 ipinfo 111278 131423983896256 IPInfo basic info response: {'ip': '185.40.4.100', 'city': 'Oslo', 'region': 'Oslo', 'country': 'NO', 'loc': '59.9127,10.7461', 'org': 'AS200195 Verasel, Inc.', 'postal': '0001', 'timezone': 'Europe/Oslo'}
INFO 2025-02-09 23:25:06,080 ipinfo 111278 131423983896256 IPInfo privacy request - URL: https://ipinfo.io/185.40.4.100/privacy?token=<hidden>
ERROR 2025-02-09 23:25:07,111 base_scanner 111278 131423983896256 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-09 23:25:07,111 ipinfo 111278 131423983896256 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-09 23:25:10,376 crowdsec 111278 131423983896256 CrowdSec raw response: {'ip': '185.40.4.100', 'reputation': 'malicious', 'ip_range': '185.40.4.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'Berdiev Ruslan Mukhabatovich', 'as_num': 214576, 'ip_range_24': '185.40.4.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'SC', 'city': None, 'latitude': -4.5833, 'longitude': 55.6667}, 'reverse_dns': None, 'behaviors': [{'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'windows:bruteforce', 'label': 'SMB/RDP bruteforce', 'description': 'IP has been reported for performing brute force on Windows (samba, remote desktop) services.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'generic:scan', 'label': 'Scan attempt', 'description': 'IP has been reported trying to scan or gather information', 'references': []}], 'history': {'first_seen': '2022-07-22T22:45:00+00:00', 'last_seen': '2025-02-09T21:30:00+00:00', 'full_age': 934, 'days_age': 933}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'LePresidente/http-generic-401-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 401 Authorization error brute force', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/CVE-2022-26134', 'label': 'Confluence CVE-2022-26134', 'description': 'Detect CVE-2022-26134 exploits', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/windows-bf', 'label': 'Windows Bruteforce', 'description': 'Detect windows auth bruteforce', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-cve-2021-41773', 'label': 'CVE-2021-41773', 'description': 'Apache - Path Traversal (CVE-2021-41773)', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'mstilkerich/bind9-refused', 'label': 'Domain transfer attempt', 'description': 'Act on queries / zone transfers denied by bind9 policy', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}], 'target_countries': {'US': 43, 'DE': 14, 'FR': 10, 'RU': 7, 'NL': 7, 'GB': 4, 'JP': 4, 'BR': 2, 'CA': 2, 'PL': 2}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}, {'name': 'T1590', 'label': 'Gather Victim Network Information', 'description': "Adversaries may gather information about the victim's networks that can be used during targeting.", 'references': []}], 'cves': ['CVE-2022-26134', 'CVE-2024-4577', 'CVE-2024-27956', 'CVE-2021-41773'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_day': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}}, 'references': [{'name': 'list:firehol_voipbl', 'label': 'Firehol voipbl.org list', 'description': "VoIPBL.org is a distributed VoIP blacklist that is aimed to protect against VoIP fraud and minimizing abuse for networks that have publicly accessible PBX's. Several algorithms, external sources and manual confirmations are used before they categorize something as an attack and determine the threat level.", 'references': ['https://iplists.firehol.org/?ipset=voipbl']}, {'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}, {'name': 'list:crowdsec_windows', 'label': 'Windows Attackers', 'description': 'Contains IPs that have been mainly reported for attacking Windows. Proactively block these IPs to protect your Windows systems and establish an overall safer perimeter.', 'references': []}]}
ERROR 2025-02-09 23:25:44,758 views 111278 131423983896256 Error analyzing IP: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/services/ip_scan/utils/platform_scoring.py", line 84, in calculate_platform_scores
    noise_score = background_noise.get('score')
                  ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 843, in analyze_ip_api
    results = await service.analyze_ip(ip_address)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 130, in analyze_ip
    score = calculate_platform_scores(data, platform)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/Agile/code/stack/main/services/ip_scan/utils/platform_scoring.py", line 99, in calculate_platform_scores
    logger.error(f"Error calculating {platform} score: {str(e)}")
    ^^^^^^
NameError: name 'logger' is not defined
ERROR 2025-02-09 23:25:44,762 log 111278 131423941953216 Internal Server Error: /threat/ip-analysis/analyze/185.40.4.100/
INFO 2025-02-09 23:26:50,594 autoreload 111278 131424134393984 /home/Agile/code/stack/main/services/ip_scan/utils/platform_scoring.py changed, reloading.
INFO 2025-02-09 23:26:51,080 autoreload 112493 140009159630976 Watching for file changes with StatReloader
INFO 2025-02-09 23:27:12,864 ip_analysis 112493 140009019541184 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-09 23:27:12,865 ip_analysis 112493 140009019541184 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-09 23:27:12,865 ip_analysis 112493 140009019541184 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-09 23:27:12,865 ip_analysis 112493 140009019541184 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-09 23:27:12,865 ip_analysis 112493 140009019541184 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-09 23:27:12,866 ip_analysis 112493 140009019541184 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-09 23:27:12,867 ip_analysis 112493 140009019541184 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-09 23:27:12,868 ip_analysis 112493 140009019541184 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-09 23:27:12,868 ip_analysis 112493 140009019541184 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-09 23:27:12,870 crowdsec 112493 140008988083904 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.40.4.101, Key Preview: QXRr***
INFO 2025-02-09 23:27:12,871 ipinfo 112493 140008988083904 IPInfo request - URL: https://ipinfo.io/185.40.4.101/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-09 23:27:13,102 ipinfo 112493 140008988083904 IPInfo basic info response: {'ip': '185.40.4.101', 'city': 'Oslo', 'region': 'Oslo', 'country': 'NO', 'loc': '59.9127,10.7461', 'org': 'AS200195 Verasel, Inc.', 'postal': '0001', 'timezone': 'Europe/Oslo'}
INFO 2025-02-09 23:27:13,103 ipinfo 112493 140008988083904 IPInfo privacy request - URL: https://ipinfo.io/185.40.4.101/privacy?token=<hidden>
INFO 2025-02-09 23:27:13,424 crowdsec 112493 140008988083904 CrowdSec raw response: {'ip': '185.40.4.101', 'reputation': 'malicious', 'ip_range': '185.40.4.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'Berdiev Ruslan Mukhabatovich', 'as_num': 214576, 'ip_range_24': '185.40.4.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'SC', 'city': None, 'latitude': -4.5833, 'longitude': 55.6667}, 'reverse_dns': None, 'behaviors': [{'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'generic:scan', 'label': 'Scan attempt', 'description': 'IP has been reported trying to scan or gather information', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}], 'history': {'first_seen': '2024-08-30T09:30:00+00:00', 'last_seen': '2025-02-08T23:30:00+00:00', 'full_age': 164, 'days_age': 163}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/CVE-2023-22515', 'label': 'Confluence CVE-2023-22515', 'description': 'Detect CVE-2023-22515 exploitation', 'references': []}, {'name': 'crowdsecurity/spring4shell_cve-2022-22965', 'label': 'Spring4shell CVE-2022-22965', 'description': 'Detect cve-2022-22965 probing', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/generic-admin-scan', 'label': 'Generic Admin Interface Scanner', 'description': 'Detect Generic Admin Interface Scanner', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'mstilkerich/bind9-refused', 'label': 'Domain transfer attempt', 'description': 'Act on queries / zone transfers denied by bind9 policy', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'LePresidente/http-generic-401-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 401 Authorization error brute force', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}], 'target_countries': {'US': 40, 'DE': 16, 'RU': 9, 'FR': 8, 'NL': 7, 'GB': 5, 'JP': 4, 'PL': 2, 'CA': 2, 'BR': 1}, 'mitre_techniques': [{'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1590', 'label': 'Gather Victim Network Information', 'description': "Adversaries may gather information about the victim's networks that can be used during targeting.", 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2023-22515', 'CVE-2022-22965', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_day': {'aggressiveness': 4, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 3}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}]}
ERROR 2025-02-09 23:27:14,135 base_scanner 112493 140008988083904 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-09 23:27:14,135 ipinfo 112493 140008988083904 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-09 23:29:32,378 autoreload 113520 124756032553088 Watching for file changes with StatReloader
INFO 2025-02-10 01:55:43,589 autoreload 129036 137267450601600 Watching for file changes with StatReloader
INFO 2025-02-10 01:56:32,556 ip_analysis 129036 137267381274304 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 01:56:32,556 ip_analysis 129036 137267381274304 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 01:56:32,557 ip_analysis 129036 137267381274304 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 01:56:32,557 ip_analysis 129036 137267381274304 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 01:56:32,557 ip_analysis 129036 137267381274304 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 01:56:32,557 ip_analysis 129036 137267381274304 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 01:56:32,557 ip_analysis 129036 137267381274304 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 01:56:32,558 ip_analysis 129036 137267381274304 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 01:56:32,558 ip_analysis 129036 137267381274304 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 01:56:32,558 ip_analysis 129036 137267381274304 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 01:56:32,558 ip_analysis 129036 137267381274304 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 01:56:32,559 ip_analysis 129036 137267381274304 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 01:56:32,559 ip_analysis 129036 137267381274304 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 01:56:32,559 ip_analysis 129036 137267381274304 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 01:56:32,559 ip_analysis 129036 137267381274304 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 01:56:32,560 ip_analysis 129036 137267381274304 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 01:56:32,560 ip_analysis 129036 137267381274304 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 01:56:32,560 ip_analysis 129036 137267381274304 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 01:56:32,560 ip_analysis 129036 137267381274304 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 01:56:32,563 crowdsec 129036 137267244959424 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.220.100.244, Key Preview: QXRr***
INFO 2025-02-10 01:56:32,564 ipinfo 129036 137267244959424 IPInfo request - URL: https://ipinfo.io/185.220.100.244/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 01:56:32,645 ipinfo 129036 137267244959424 IPInfo basic info response: {'ip': '185.220.100.244', 'hostname': 'tor-exit-5.zbau.f3netze.de', 'city': 'Erlangen', 'region': 'Bavaria', 'country': 'DE', 'loc': '49.5910,11.0078', 'org': 'AS205100 F3 Netze e.V.', 'postal': '91052', 'timezone': 'Europe/Berlin'}
INFO 2025-02-10 01:56:32,645 ipinfo 129036 137267244959424 IPInfo privacy request - URL: https://ipinfo.io/185.220.100.244/privacy?token=<hidden>
INFO 2025-02-10 01:56:33,081 crowdsec 129036 137267244959424 CrowdSec raw response: {'ip': '185.220.100.244', 'reputation': 'malicious', 'ip_range': '185.220.100.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'F3 Netze e.V.', 'as_num': 205100, 'ip_range_24': '185.220.100.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'DE', 'city': None, 'latitude': 51.2993, 'longitude': 9.491}, 'reverse_dns': 'tor-exit-5.zbau.f3netze.de', 'behaviors': [{'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'tcp:scan', 'label': 'TCP Scan', 'description': 'IP has been reported for performing TCP port scanning.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'pop3/imap:bruteforce', 'label': 'POP3/IMAP Bruteforce', 'description': 'IP has been reported for performing a POP3/IMAP brute force attack.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}], 'history': {'first_seen': '2021-02-25T18:30:00+00:00', 'last_seen': '2025-02-09T05:00:00+00:00', 'full_age': 1446, 'days_age': 1445}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'firewallservices/pf-scan-multi_ports', 'label': 'PF Scan Multi Ports', 'description': 'Detect aggressive portscans (pf)', 'references': []}, {'name': 'crowdsecurity/dovecot-spam', 'label': 'Dovecot Bruteforce', 'description': 'detect errors on dovecot', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'LePresidente/http-generic-401-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 401 Authorization error brute force', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-cve-2021-41773', 'label': 'CVE-2021-41773', 'description': 'Apache - Path Traversal (CVE-2021-41773)', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/CVE-2017-9841', 'label': 'PHPUnit - RCE', 'description': 'PHPUnit - RCE (CVE-2017-9841)', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}], 'target_countries': {'US': 41, 'DE': 17, 'FR': 10, 'NL': 6, 'JP': 5, 'RU': 5, 'GB': 4, 'PL': 3, 'CA': 3, 'AU': 2}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1018', 'label': 'Remote System Discovery', 'description': 'Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.', 'references': []}, {'name': 'T1046', 'label': 'Network Service Discovery', 'description': 'Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}], 'cves': ['CVE-2021-41773', 'CVE-2017-9841', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_day': {'aggressiveness': 4, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 3}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:firehol_botscout_7d', 'label': 'Firehol BotScout list', 'description': 'BotScout helps prevent automated web scripts, known as bots, from registering on forums, polluting databases, spreading spam, and abusing forms on web sites. They do this by tracking the names, IPs, and email addresses that bots use and logging them as unique signatures for future reference. This list is composed of the most recently-caught bots.', 'references': ['https://iplists.firehol.org/?ipset=botscout_7d']}]}
ERROR 2025-02-10 01:56:33,676 base_scanner 129036 137267244959424 ipinfo API authentication error. Status: 403, Response: {
  "status": 403,
  "error": {
    "title": "Invalid Permissions",
    "message": "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeat
INFO 2025-02-10 01:56:33,677 ipinfo 129036 137267244959424 IPInfo privacy response: {'error': 'API authentication error. Check API key.', 'details': {'status': 403, 'error': {'title': 'Invalid Permissions', 'message': "This token doesn't have permissions for 'privacy' module. Please subscribe from https://ipinfo.io/account/ipinfoFeatures."}}}
INFO 2025-02-10 01:59:45,304 autoreload 129036 137267450601600 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-10 01:59:45,727 autoreload 130066 140236510429312 Watching for file changes with StatReloader
INFO 2025-02-10 02:02:06,504 autoreload 130066 140236510429312 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-10 02:02:06,949 autoreload 130632 136238872346752 Watching for file changes with StatReloader
INFO 2025-02-10 02:03:21,927 ip_analysis 130632 136238803715776 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:03:21,927 ip_analysis 130632 136238803715776 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:03:21,927 ip_analysis 130632 136238803715776 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:03:21,928 ip_analysis 130632 136238803715776 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:03:21,928 ip_analysis 130632 136238803715776 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:03:21,928 ip_analysis 130632 136238803715776 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:03:21,928 ip_analysis 130632 136238803715776 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:03:21,928 ip_analysis 130632 136238803715776 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:03:21,929 ip_analysis 130632 136238803715776 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:03:21,930 ip_analysis 130632 136238803715776 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:03:21,930 ip_analysis 130632 136238803715776 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:03:21,930 ip_analysis 130632 136238803715776 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:03:21,930 ip_analysis 130632 136238803715776 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:03:21,930 ip_analysis 130632 136238803715776 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
ERROR 2025-02-10 02:03:21,931 views 130632 136238793230016 Error analyzing IP: Can't instantiate abstract class IPInfoScanner without an implementation for abstract method 'extract_network_info'
Traceback (most recent call last):
  File "/home/Agile/code/stack/main/views.py", line 842, in analyze_ip_api
    async with IPAnalysisService() as service:  # Removed request.user parameter
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 41, in __aenter__
    await self.initialize_scanners()
  File "/home/Agile/code/stack/main/services/ip_scan/ip_analysis.py", line 92, in initialize_scanners
    self.scanners[platform] = scanner_class(self.session, api_key)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Can't instantiate abstract class IPInfoScanner without an implementation for abstract method 'extract_network_info'
ERROR 2025-02-10 02:03:21,932 base_events 130632 136238793230016 Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x7be8918fef60>
ERROR 2025-02-10 02:03:21,933 log 130632 136238803715776 Internal Server Error: /threat/ip-analysis/analyze/192.42.116.174/
INFO 2025-02-10 02:03:48,314 autoreload 130632 136238872346752 /home/Agile/code/stack/main/services/ip_scan/platforms/ipinfo.py changed, reloading.
INFO 2025-02-10 02:03:48,814 autoreload 131081 137948546396288 Watching for file changes with StatReloader
INFO 2025-02-10 02:03:58,869 ip_analysis 131081 137948477523648 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:03:58,870 ip_analysis 131081 137948477523648 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:03:58,870 ip_analysis 131081 137948477523648 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:03:58,870 ip_analysis 131081 137948477523648 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:03:58,870 ip_analysis 131081 137948477523648 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:03:58,871 ip_analysis 131081 137948477523648 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:03:58,871 ip_analysis 131081 137948477523648 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:03:58,871 ip_analysis 131081 137948477523648 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:03:58,871 ip_analysis 131081 137948477523648 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:03:58,871 ip_analysis 131081 137948477523648 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:03:58,872 ip_analysis 131081 137948477523648 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:03:58,872 ip_analysis 131081 137948477523648 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:03:58,872 ip_analysis 131081 137948477523648 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:03:58,872 ip_analysis 131081 137948477523648 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:03:58,872 ip_analysis 131081 137948477523648 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:03:58,873 ip_analysis 131081 137948477523648 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:03:58,873 ip_analysis 131081 137948477523648 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:03:58,873 ip_analysis 131081 137948477523648 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:03:58,873 ip_analysis 131081 137948477523648 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:03:58,876 crowdsec 131081 137948456552128 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/192.42.116.174, Key Preview: QXRr***
INFO 2025-02-10 02:03:58,877 ipinfo 131081 137948456552128 IPInfo request - URL: https://ipinfo.io/192.42.116.174/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:03:59,117 ipinfo 131081 137948456552128 IPInfo basic info response: {'ip': '192.42.116.174', 'hostname': '22.tor-exit.nothingtohide.nl', 'city': 'Nieuwegein', 'region': 'Utrecht', 'country': 'NL', 'loc': '52.0292,5.0806', 'org': 'AS1101 SURF B.V.', 'postal': '3431', 'timezone': 'Europe/Amsterdam'}
INFO 2025-02-10 02:03:59,366 crowdsec 131081 137948456552128 CrowdSec raw response: {'ip': '192.42.116.174', 'reputation': 'malicious', 'ip_range': '192.42.116.0/22', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'SURF B.V.', 'as_num': 1101, 'ip_range_24': '192.42.116.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'NL', 'city': None, 'latitude': 52.3824, 'longitude': 4.8995}, 'reverse_dns': '22.tor-exit.nothingtohide.nl', 'behaviors': [{'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'ssh:bruteforce', 'label': 'SSH Bruteforce', 'description': 'IP has been reported for performing brute force on ssh services.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}], 'history': {'first_seen': '2023-02-05T11:45:00+00:00', 'last_seen': '2025-02-09T05:45:00+00:00', 'full_age': 736, 'days_age': 735}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'profile:many_services', 'label': 'Many Services Exposed', 'description': "IP exposes many open ports, possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'profile:insecure_services', 'label': 'Dangerous Services Exposed', 'description': "IP exposes dangerous services (VNC, Telnet, RDP), possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'LePresidente/http-generic-401-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 401 Authorization error brute force', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/vpatch-git-config', 'label': 'Access to .git file', 'description': 'Detect access to .git files', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/http-crawl-non_statics', 'label': 'Aggressive Crawl', 'description': 'Detect aggressive crawl on non static resources', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/ssh-slow-bf', 'label': 'SSH Slow Bruteforce', 'description': 'Detect slow ssh bruteforce', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/ssh-bf', 'label': 'SSH Bruteforce', 'description': 'Detect ssh bruteforce', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}], 'target_countries': {'US': 37, 'DE': 17, 'FR': 11, 'NL': 9, 'RU': 6, 'JP': 5, 'GB': 4, 'PL': 3, 'CA': 2, 'AU': 1}, 'mitre_techniques': [{'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}], 'cves': ['CVE-2024-4577', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 4, 'trust': 5, 'anomaly': 3, 'total': 5}, 'last_day': {'aggressiveness': 4, 'threat': 3, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 4, 'trust': 5, 'anomaly': 3, 'total': 5}, 'last_month': {'aggressiveness': 5, 'threat': 4, 'trust': 5, 'anomaly': 3, 'total': 5}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
INFO 2025-02-10 02:09:24,613 ip_analysis 131081 137948477523648 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:09:24,614 ip_analysis 131081 137948477523648 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:09:24,614 ip_analysis 131081 137948477523648 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:09:24,614 ip_analysis 131081 137948477523648 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:09:24,614 ip_analysis 131081 137948477523648 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:09:24,615 ip_analysis 131081 137948477523648 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:09:24,615 ip_analysis 131081 137948477523648 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:09:24,615 ip_analysis 131081 137948477523648 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:09:24,615 ip_analysis 131081 137948477523648 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:09:24,615 ip_analysis 131081 137948477523648 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:09:24,616 ip_analysis 131081 137948477523648 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:09:24,617 ip_analysis 131081 137948477523648 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:09:24,617 ip_analysis 131081 137948477523648 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:09:24,617 ip_analysis 131081 137948477523648 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:09:24,621 crowdsec 131081 137948456552128 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.107.57.64, Key Preview: QXRr***
INFO 2025-02-10 02:09:24,622 ipinfo 131081 137948456552128 IPInfo request - URL: https://ipinfo.io/185.107.57.64/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:09:24,699 ipinfo 131081 137948456552128 IPInfo basic info response: {'ip': '185.107.57.64', 'city': 'Roosendaal', 'region': 'North Brabant', 'country': 'NL', 'loc': '51.5308,4.4653', 'org': 'AS43350 NForce Entertainment B.V.', 'postal': '4701', 'timezone': 'Europe/Amsterdam'}
INFO 2025-02-10 02:09:25,188 crowdsec 131081 137948456552128 CrowdSec raw response: {'ip': '185.107.57.64', 'reputation': 'malicious', 'ip_range': '185.107.56.0/22', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'NForce Entertainment B.V.', 'as_num': 43350, 'ip_range_24': '185.107.57.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'NL', 'city': None, 'latitude': 52.3824, 'longitude': 4.8995}, 'reverse_dns': None, 'behaviors': [{'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}], 'history': {'first_seen': '2024-06-04T01:45:00+00:00', 'last_seen': '2025-02-10T00:45:00+00:00', 'full_age': 252, 'days_age': 251}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/generic-backdoors', 'label': 'Scanning for backdoors', 'description': 'Detect attempt to common backdoors', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/CVE-2017-9841', 'label': 'PHPUnit - RCE', 'description': 'PHPUnit - RCE (CVE-2017-9841)', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}], 'target_countries': {'US': 43, 'DE': 14, 'FR': 11, 'NL': 6, 'RU': 6, 'GB': 4, 'JP': 3, 'PL': 3, 'CA': 2, 'AU': 2}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2017-9841', 'CVE-2024-27956', 'CVE-2024-4577'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_day': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 2, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
INFO 2025-02-10 02:12:30,587 ip_analysis 131081 137948477523648 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:12:30,587 ip_analysis 131081 137948477523648 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:12:30,587 ip_analysis 131081 137948477523648 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:12:30,587 ip_analysis 131081 137948477523648 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:12:30,588 ip_analysis 131081 137948477523648 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:12:30,588 ip_analysis 131081 137948477523648 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:12:30,588 ip_analysis 131081 137948477523648 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:12:30,588 ip_analysis 131081 137948477523648 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:12:30,589 ip_analysis 131081 137948477523648 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:12:30,589 ip_analysis 131081 137948477523648 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:12:30,589 ip_analysis 131081 137948477523648 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:12:30,589 ip_analysis 131081 137948477523648 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:12:30,589 ip_analysis 131081 137948477523648 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:12:30,590 ip_analysis 131081 137948477523648 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:12:30,593 crowdsec 131081 137948467037888 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/192.42.116.202, Key Preview: QXRr***
INFO 2025-02-10 02:12:30,594 ipinfo 131081 137948467037888 IPInfo request - URL: https://ipinfo.io/192.42.116.202/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:12:30,773 ipinfo 131081 137948467037888 IPInfo basic info response: {'ip': '192.42.116.202', 'hostname': '39.tor-exit.nothingtohide.nl', 'city': 'Nieuwegein', 'region': 'Utrecht', 'country': 'NL', 'loc': '52.0292,5.0806', 'org': 'AS1101 SURF B.V.', 'postal': '3431', 'timezone': 'Europe/Amsterdam'}
WARNING 2025-02-10 02:12:30,797 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:12:31,307 crowdsec 131081 137948467037888 CrowdSec raw response: {'ip': '192.42.116.202', 'reputation': 'malicious', 'ip_range': '192.42.116.0/22', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'SURF B.V.', 'as_num': 1101, 'ip_range_24': '192.42.116.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'NL', 'city': None, 'latitude': 52.3824, 'longitude': 4.8995}, 'reverse_dns': '39.tor-exit.nothingtohide.nl', 'behaviors': [{'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'pop3/imap:bruteforce', 'label': 'POP3/IMAP Bruteforce', 'description': 'IP has been reported for performing a POP3/IMAP brute force attack.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}], 'history': {'first_seen': '2022-12-26T01:15:00+00:00', 'last_seen': '2025-02-09T07:45:00+00:00', 'full_age': 778, 'days_age': 777}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'profile:insecure_services', 'label': 'Dangerous Services Exposed', 'description': "IP exposes dangerous services (VNC, Telnet, RDP), possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'profile:many_services', 'label': 'Many Services Exposed', 'description': "IP exposes many open ports, possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/dovecot-spam', 'label': 'Dovecot Bruteforce', 'description': 'detect errors on dovecot', 'references': []}, {'name': 'crowdsecurity/http-crawl-non_statics', 'label': 'Aggressive Crawl', 'description': 'Detect aggressive crawl on non static resources', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}], 'target_countries': {'US': 37, 'DE': 15, 'FR': 11, 'NL': 8, 'RU': 6, 'JP': 5, 'PL': 5, 'GB': 4, 'CA': 2, 'SG': 1}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2024-4577', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 3, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_day': {'aggressiveness': 4, 'threat': 2, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 3, 'trust': 5, 'anomaly': 3, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
WARNING 2025-02-10 02:12:32,804 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:12:34,811 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:12:36,816 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:12:38,822 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:12:40,828 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:12:42,835 base_scanner 131081 137948467037888 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:13:02,880 autoreload 133405 138744723980416 Watching for file changes with StatReloader
INFO 2025-02-10 02:13:19,721 ip_analysis 133405 138744654988992 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:13:19,721 ip_analysis 133405 138744654988992 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:13:19,722 ip_analysis 133405 138744654988992 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:13:19,722 ip_analysis 133405 138744654988992 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:13:19,722 ip_analysis 133405 138744654988992 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:13:19,722 ip_analysis 133405 138744654988992 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:13:19,722 ip_analysis 133405 138744654988992 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:13:19,723 ip_analysis 133405 138744654988992 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:13:19,723 ip_analysis 133405 138744654988992 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:13:19,723 ip_analysis 133405 138744654988992 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:13:19,723 ip_analysis 133405 138744654988992 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:13:19,723 ip_analysis 133405 138744654988992 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:13:19,724 ip_analysis 133405 138744654988992 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:13:19,724 ip_analysis 133405 138744654988992 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:13:19,724 ip_analysis 133405 138744654988992 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:13:19,724 ip_analysis 133405 138744654988992 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:13:19,724 ip_analysis 133405 138744654988992 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:13:19,725 ip_analysis 133405 138744654988992 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:13:19,725 ip_analysis 133405 138744654988992 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:13:19,727 crowdsec 133405 138744554325696 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/192.42.116.202, Key Preview: QXRr***
INFO 2025-02-10 02:13:19,728 ipinfo 133405 138744554325696 IPInfo request - URL: https://ipinfo.io/192.42.116.202/json?token=<hidden>, Key Preview: e94d***
WARNING 2025-02-10 02:13:19,753 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:13:19,776 ipinfo 133405 138744554325696 IPInfo basic info response: {'ip': '192.42.116.202', 'hostname': '39.tor-exit.nothingtohide.nl', 'city': 'Nieuwegein', 'region': 'Utrecht', 'country': 'NL', 'loc': '52.0292,5.0806', 'org': 'AS1101 SURF B.V.', 'postal': '3431', 'timezone': 'Europe/Amsterdam'}
INFO 2025-02-10 02:13:20,493 crowdsec 133405 138744554325696 CrowdSec raw response: {'ip': '192.42.116.202', 'reputation': 'malicious', 'ip_range': '192.42.116.0/22', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'SURF B.V.', 'as_num': 1101, 'ip_range_24': '192.42.116.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'NL', 'city': None, 'latitude': 52.3824, 'longitude': 4.8995}, 'reverse_dns': '39.tor-exit.nothingtohide.nl', 'behaviors': [{'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'pop3/imap:bruteforce', 'label': 'POP3/IMAP Bruteforce', 'description': 'IP has been reported for performing a POP3/IMAP brute force attack.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}], 'history': {'first_seen': '2022-12-26T01:15:00+00:00', 'last_seen': '2025-02-09T07:45:00+00:00', 'full_age': 778, 'days_age': 777}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'profile:insecure_services', 'label': 'Dangerous Services Exposed', 'description': "IP exposes dangerous services (VNC, Telnet, RDP), possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'profile:many_services', 'label': 'Many Services Exposed', 'description': "IP exposes many open ports, possibly due to a misconfiguration or because it's a honeypot.", 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/dovecot-spam', 'label': 'Dovecot Bruteforce', 'description': 'detect errors on dovecot', 'references': []}, {'name': 'crowdsecurity/http-crawl-non_statics', 'label': 'Aggressive Crawl', 'description': 'Detect aggressive crawl on non static resources', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}], 'target_countries': {'US': 37, 'DE': 15, 'FR': 11, 'NL': 8, 'RU': 6, 'JP': 5, 'PL': 5, 'GB': 4, 'CA': 2, 'SG': 1}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2024-4577', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 3, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_day': {'aggressiveness': 4, 'threat': 2, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 3, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 3, 'trust': 5, 'anomaly': 3, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
WARNING 2025-02-10 02:13:21,759 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:13:23,767 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:13:25,773 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:13:27,779 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:13:29,786 base_scanner 133405 138744554325696 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:15:06,064 autoreload 134024 135302470135936 Watching for file changes with StatReloader
INFO 2025-02-10 02:15:17,073 ip_analysis 134024 135302333073088 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:15:17,073 ip_analysis 134024 135302333073088 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:15:17,074 ip_analysis 134024 135302333073088 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:15:17,074 ip_analysis 134024 135302333073088 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:15:17,074 ip_analysis 134024 135302333073088 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:15:17,074 ip_analysis 134024 135302333073088 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:15:17,075 ip_analysis 134024 135302333073088 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:15:17,075 ip_analysis 134024 135302333073088 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:15:17,075 ip_analysis 134024 135302333073088 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:15:17,075 ip_analysis 134024 135302333073088 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:15:17,075 ip_analysis 134024 135302333073088 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:15:17,076 ip_analysis 134024 135302333073088 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:15:17,076 ip_analysis 134024 135302333073088 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:15:17,076 ip_analysis 134024 135302333073088 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:15:17,076 ip_analysis 134024 135302333073088 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:15:17,076 ip_analysis 134024 135302333073088 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:15:17,077 ip_analysis 134024 135302333073088 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:15:17,077 ip_analysis 134024 135302333073088 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:15:17,077 ip_analysis 134024 135302333073088 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:15:17,080 crowdsec 134024 135302301615808 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.220.101.38, Key Preview: QXRr***
INFO 2025-02-10 02:15:17,081 ipinfo 134024 135302301615808 IPInfo request - URL: https://ipinfo.io/185.220.101.38/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:15:17,213 ipinfo 134024 135302301615808 IPInfo basic info response: {'ip': '185.220.101.38', 'hostname': 'tor-exit-38.for-privacy.net', 'city': 'Berlin', 'region': 'Berlin', 'country': 'DE', 'loc': '52.5244,13.4105', 'org': 'AS60729 Stiftung Erneuerbare Freiheit', 'postal': '10119', 'timezone': 'Europe/Berlin'}
WARNING 2025-02-10 02:15:17,235 base_scanner 134024 135302301615808 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:15:17,639 crowdsec 134024 135302301615808 CrowdSec raw response: {'ip': '185.220.101.38', 'reputation': 'malicious', 'ip_range': '185.220.101.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'Stiftung Erneuerbare Freiheit', 'as_num': 60729, 'ip_range_24': '185.220.101.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'DE', 'city': 'Brandenburg', 'latitude': 52.6171, 'longitude': 13.1207}, 'reverse_dns': 'tor-exit-38.for-privacy.net', 'behaviors': [{'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'tcp:scan', 'label': 'TCP Scan', 'description': 'IP has been reported for performing TCP port scanning.', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'ssh:bruteforce', 'label': 'SSH Bruteforce', 'description': 'IP has been reported for performing brute force on ssh services.', 'references': []}], 'history': {'first_seen': '2021-10-08T21:00:00+00:00', 'last_seen': '2025-02-09T02:00:00+00:00', 'full_age': 1221, 'days_age': 1220}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'firewallservices/pf-scan-multi_ports', 'label': 'PF Scan Multi Ports', 'description': 'Detect aggressive portscans (pf)', 'references': []}, {'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/CVE-2017-9841', 'label': 'PHPUnit - RCE', 'description': 'PHPUnit - RCE (CVE-2017-9841)', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/ssh-bf', 'label': 'SSH Bruteforce', 'description': 'Detect ssh bruteforce', 'references': []}, {'name': 'crowdsecurity/suricata-high-medium-severity', 'label': 'Suricata Severity 2 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}], 'target_countries': {'US': 39, 'DE': 16, 'FR': 10, 'NL': 7, 'RU': 7, 'JP': 6, 'GB': 5, 'PL': 2, 'CA': 2, 'IN': 2}, 'mitre_techniques': [{'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1018', 'label': 'Remote System Discovery', 'description': 'Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.', 'references': []}, {'name': 'T1046', 'label': 'Network Service Discovery', 'description': 'Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2024-27956', 'CVE-2024-4577', 'CVE-2017-9841'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_day': {'aggressiveness': 4, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 3}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
WARNING 2025-02-10 02:15:19,244 base_scanner 134024 135302301615808 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:15:21,251 base_scanner 134024 135302301615808 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:15:23,258 base_scanner 134024 135302301615808 greynoise rate limit hit, waiting 2 seconds
WARNING 2025-02-10 02:15:25,264 base_scanner 134024 135302301615808 greynoise rate limit hit, waiting 2 seconds
INFO 2025-02-10 02:16:36,917 autoreload 134489 129966028624000 Watching for file changes with StatReloader
INFO 2025-02-10 02:16:51,021 ip_analysis 134489 129965959939776 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:16:51,021 ip_analysis 134489 129965959939776 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:16:51,022 ip_analysis 134489 129965959939776 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:16:51,022 ip_analysis 134489 129965959939776 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:16:51,022 ip_analysis 134489 129965959939776 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:16:51,022 ip_analysis 134489 129965959939776 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:16:51,023 ip_analysis 134489 129965959939776 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:16:51,024 ip_analysis 134489 129965959939776 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:16:51,024 ip_analysis 134489 129965959939776 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:16:51,024 ip_analysis 134489 129965959939776 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:16:51,024 ip_analysis 134489 129965959939776 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:16:51,024 ip_analysis 134489 129965959939776 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:16:51,025 ip_analysis 134489 129965959939776 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:16:51,025 ip_analysis 134489 129965959939776 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:16:51,027 crowdsec 134489 129965832013504 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/185.220.101.29, Key Preview: QXRr***
INFO 2025-02-10 02:16:51,028 ipinfo 134489 129965832013504 IPInfo request - URL: https://ipinfo.io/185.220.101.29/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:16:51,176 ipinfo 134489 129965832013504 IPInfo basic info response: {'ip': '185.220.101.29', 'hostname': 'berlin01.tor-exit.artikel10.org', 'city': 'Berlin', 'region': 'Berlin', 'country': 'DE', 'loc': '52.5244,13.4105', 'org': 'AS60729 Stiftung Erneuerbare Freiheit', 'postal': '10119', 'timezone': 'Europe/Berlin'}
WARNING 2025-02-10 02:16:51,231 base_scanner 134489 129965832013504 greynoise rate limit hit
WARNING 2025-02-10 02:16:51,232 greynoise 134489 129965832013504 GreyNoise rate limit hit, disabling further requests
INFO 2025-02-10 02:16:51,581 crowdsec 134489 129965832013504 CrowdSec raw response: {'ip': '185.220.101.29', 'reputation': 'malicious', 'ip_range': '185.220.101.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'Stiftung Erneuerbare Freiheit', 'as_num': 60729, 'ip_range_24': '185.220.101.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'DE', 'city': 'Brandenburg', 'latitude': 52.6171, 'longitude': 13.1207}, 'reverse_dns': 'berlin01.tor-exit.artikel10.org', 'behaviors': [{'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}], 'history': {'first_seen': '2021-12-11T07:45:00+00:00', 'last_seen': '2025-02-09T21:45:00+00:00', 'full_age': 1158, 'days_age': 1157}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-wordpress-scan', 'label': 'WordPress Vuln Hunting', 'description': 'Detect WordPress scan: vuln hunting', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf_xmlrpc', 'label': 'WP XMLRPC bruteforce', 'description': 'Detect WordPress bruteforce on XML-RPC endpoint', 'references': []}, {'name': 'crowdsecurity/http-crawl-non_statics', 'label': 'Aggressive Crawl', 'description': 'Detect aggressive crawl on non static resources', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-admin-interface-probing', 'label': 'HTTP Admin Interface Probing', 'description': 'Detect generic HTTP admin interface probing', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-open-proxy', 'label': 'HTTP Open Proxy Probing', 'description': 'Detect scan for open proxy', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}], 'target_countries': {'US': 37, 'DE': 21, 'FR': 11, 'NL': 7, 'RU': 5, 'JP': 5, 'PL': 4, 'GB': 2, 'CA': 1, 'AU': 1}, 'mitre_techniques': [{'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}, {'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}], 'cves': ['CVE-2024-4577', 'CVE-2024-27956'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_day': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}}, 'references': [{'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}, {'name': 'list:firehol_greensnow', 'label': 'Firehol greensnow.co list', 'description': 'GreenSnow is a team harvesting a large number of IPs from different computers located around the world. GreenSnow is comparable with SpamHaus.org for attacks of any kind except for spam. Their list is updated automatically and you can withdraw at any time your IP address if it has been listed. Attacks / bruteforce that are monitored are: Scan Port, FTP, POP3, mod_security, IMAP, SMTP, SSH, cPanel, etc.', 'references': ['https://iplists.firehol.org/?ipset=greensnow']}]}
INFO 2025-02-10 02:24:06,008 ip_analysis 134489 129965959939776 Retrieved key for platform virustotal: success (preview: 1f63***)
INFO 2025-02-10 02:24:06,008 ip_analysis 134489 129965959939776 Retrieved key for platform abuseipdb: success (preview: c904***)
INFO 2025-02-10 02:24:06,009 ip_analysis 134489 129965959939776 Retrieved key for platform alienvault: success (preview: 74a4***)
INFO 2025-02-10 02:24:06,009 ip_analysis 134489 129965959939776 Retrieved key for platform ibm_xforce: success (preview: d291***)
INFO 2025-02-10 02:24:06,009 ip_analysis 134489 129965959939776 Retrieved key for platform urlscan: success (preview: f91b***)
INFO 2025-02-10 02:24:06,009 ip_analysis 134489 129965959939776 Retrieved key for platform securitytrails: success (preview: 9eID***)
INFO 2025-02-10 02:24:06,010 ip_analysis 134489 129965959939776 Retrieved key for platform hybrid_analysis: success (preview: vfhd***)
INFO 2025-02-10 02:24:06,010 ip_analysis 134489 129965959939776 Retrieved key for platform pulsedive: success (preview: 5458***)
INFO 2025-02-10 02:24:06,010 ip_analysis 134489 129965959939776 Retrieved key for platform filescan: success (preview: K5HA***)
INFO 2025-02-10 02:24:06,010 ip_analysis 134489 129965959939776 Retrieved key for platform malwarebazaar: success (preview: 66ec***)
INFO 2025-02-10 02:24:06,010 ip_analysis 134489 129965959939776 Retrieved key for platform threatfox: success (preview: 66ec***)
INFO 2025-02-10 02:24:06,011 ip_analysis 134489 129965959939776 Retrieved key for platform urlhaus: success (preview: 66ec***)
INFO 2025-02-10 02:24:06,011 ip_analysis 134489 129965959939776 Retrieved key for platform spamhaus: success (preview: M2tY***)
INFO 2025-02-10 02:24:06,011 ip_analysis 134489 129965959939776 Retrieved key for platform cloudmersive: success (preview: 3193***)
INFO 2025-02-10 02:24:06,011 ip_analysis 134489 129965959939776 Retrieved key for platform metadefender: success (preview: 9387***)
INFO 2025-02-10 02:24:06,012 ip_analysis 134489 129965959939776 Retrieved key for platform greynoise: success (preview: byFS***)
INFO 2025-02-10 02:24:06,012 ip_analysis 134489 129965959939776 Retrieved key for platform ipinfo: success (preview: e94d***)
INFO 2025-02-10 02:24:06,012 ip_analysis 134489 129965959939776 Retrieved key for platform crowdsec: success (preview: QXRr***)
INFO 2025-02-10 02:24:06,012 ip_analysis 134489 129965959939776 Retrieved 18 valid API keys for platforms: virustotal, abuseipdb, alienvault, ibm_xforce, urlscan, securitytrails, hybrid_analysis, pulsedive, filescan, malwarebazaar, threatfox, urlhaus, spamhaus, cloudmersive, metadefender, greynoise, ipinfo, crowdsec
INFO 2025-02-10 02:24:06,016 crowdsec 134489 129965641172672 CrowdSec request - URL: https://cti.api.crowdsec.net/v2/smoke/171.25.193.20, Key Preview: QXRr***
INFO 2025-02-10 02:24:06,017 ipinfo 134489 129965641172672 IPInfo request - URL: https://ipinfo.io/171.25.193.20/json?token=<hidden>, Key Preview: e94d***
INFO 2025-02-10 02:24:06,097 ipinfo 134489 129965641172672 IPInfo basic info response: {'ip': '171.25.193.20', 'hostname': 'tor-exit-read-me.dfri.se', 'city': 'Stockholm', 'region': 'Stockholm', 'country': 'SE', 'loc': '59.3294,18.0687', 'org': 'AS198093 Foreningen for digitala fri- och rattigheter', 'postal': '195 87', 'timezone': 'Europe/Stockholm'}
WARNING 2025-02-10 02:24:06,156 base_scanner 134489 129965641172672 greynoise rate limit hit
WARNING 2025-02-10 02:24:06,156 greynoise 134489 129965641172672 GreyNoise rate limit hit, disabling further requests
INFO 2025-02-10 02:24:06,484 crowdsec 134489 129965641172672 CrowdSec raw response: {'ip': '171.25.193.20', 'reputation': 'malicious', 'ip_range': '171.25.193.0/24', 'background_noise': 'high', 'confidence': 'high', 'background_noise_score': 10, 'ip_range_score': 5, 'as_name': 'Foreningen for digitala fri- och rattigheter', 'as_num': 198093, 'ip_range_24': '171.25.193.0/24', 'ip_range_24_reputation': 'malicious', 'ip_range_24_score': 5, 'location': {'country': 'SE', 'city': None, 'latitude': 59.3247, 'longitude': 18.056}, 'reverse_dns': 'tor-exit-read-me.dfri.se', 'behaviors': [{'name': 'http:crawl', 'label': 'HTTP Crawl', 'description': 'IP has been reported for performing aggressive crawling of web applications.', 'references': []}, {'name': 'http:spam', 'label': 'Web form spam', 'description': 'IP has been reported trying to perform spam via web forms/forums.', 'references': []}, {'name': 'http:scan', 'label': 'HTTP Scan', 'description': 'IP has been reported for performing actions related to HTTP vulnerability scanning and discovery.', 'references': []}, {'name': 'http:bruteforce', 'label': 'HTTP Bruteforce', 'description': 'IP has been reported for performing a HTTP brute force attack (either generic HTTP probing or applicative related brute force).', 'references': []}, {'name': 'generic:exploit', 'label': 'Exploitation attempt', 'description': 'IP has been reported trying to exploit known vulnerability/CVE on unspecified protocols.', 'references': []}, {'name': 'http:dos', 'label': 'HTTP DoS', 'description': 'IP has been reported trying to perform denial of service attacks.', 'references': []}, {'name': 'http:exploit', 'label': 'HTTP Exploit', 'description': 'IP has been reported for attempting to exploit a vulnerability in a web application.', 'references': []}], 'history': {'first_seen': '2020-12-02T00:00:00+00:00', 'last_seen': '2025-02-09T19:00:00+00:00', 'full_age': 1532, 'days_age': 1531}, 'classifications': {'false_positives': [], 'classifications': [{'name': 'profile:spoofed_user_agent', 'label': 'Spoofed User Agent', 'description': 'IP uses rapidly changing user agents.', 'references': []}, {'name': 'proxy:tor', 'label': 'TOR exit node', 'description': 'IP is being flagged as a TOR exit node.', 'references': []}, {'name': 'crowdsec:ai_vpn_proxy', 'label': 'VPN or Proxy', 'description': 'IP is identified as a VPN or a Proxy by CrowdSec AI Detection Algorithm.', 'references': []}, {'name': 'community-blocklist', 'label': 'CrowdSec Community Blocklist', 'description': 'IP belongs to the CrowdSec Community Blocklist'}]}, 'attack_details': [{'name': 'crowdsecurity/suricata-major-severity', 'label': 'Suricata Severity 1 Event', 'description': 'Detect exploit attempts via emerging threat rules', 'references': []}, {'name': 'crowdsecurity/http-bf-wordpress_bf', 'label': 'WordPress Bruteforce', 'description': 'Detect WordPress bruteforce on admin interface', 'references': []}, {'name': 'crowdsecurity/http-dos-invalid-http-versions', 'label': 'HTTP DOS with invalid HTTP version', 'description': 'Detect DoS tools using invalid HTTP versions', 'references': []}, {'name': 'crowdsecurity/wordpress_wpconfig_scan', 'label': 'Wordpress wpconfig scan', 'description': 'Detect WordPress wpconfig scan', 'references': []}, {'name': 'crowdsecurity/http-path-traversal-probing', 'label': 'HTTP Path Traversal Exploit', 'description': 'Detect path traversal attempt', 'references': []}, {'name': 'crowdsecurity/http-bad-user-agent', 'label': 'Bad User Agent', 'description': 'Detect usage of bad User Agent', 'references': []}, {'name': 'crowdsecurity/generic-env', 'label': '.env file Scanner', 'description': "Detect unauthorized access to '.env' file", 'references': []}, {'name': 'crowdsecurity/http-wordpress_wpconfig', 'label': 'Access to WordPress wp-config.php', 'description': 'Detect WordPress probing: variations around wp-config.php by wpscan', 'references': []}, {'name': 'crowdsecurity/http-probing', 'label': 'HTTP Probing', 'description': 'Detect site scanning/probing from a single ip', 'references': []}, {'name': 'crowdsecurity/nginx-req-limit-exceeded', 'label': 'Nginx request limit exceeded', 'description': "Detects IPs which violate nginx's user set request limit.", 'references': []}, {'name': 'crowdsecurity/CVE-2024-4577', 'label': 'PHP/XAMPP - Windows RCE', 'description': 'PHP/XAMPP - RCE (CVE-2024-4577)', 'references': []}, {'name': 'crowdsecurity/http-cve-probing', 'label': 'HTTP CVE Probing', 'description': 'Detect generic HTTP cve probing', 'references': []}, {'name': 'crowdsecurity/wordpress_plugins_fingerprint', 'label': 'Wordpress Plugin Fingerprint', 'description': 'Detect WordPress plugins fingerprint', 'references': []}, {'name': 'crowdsecurity/http-xss-probbing', 'label': 'XSS Attempt', 'description': 'A scenario that detects XSS probing with minimal false positives', 'references': []}, {'name': 'crowdsecurity/CVE-2024-27956', 'label': 'ValvePress - SQLi', 'description': 'ValvePress SQLi (CVE-2024-27956)', 'references': []}, {'name': 'LePresidente/http-generic-403-bf', 'label': 'HTTP Bruteforce', 'description': 'Detect generic 403 Forbidden (Authorization) error brute force', 'references': []}, {'name': 'crowdsecurity/http-dos-swithcing-ua', 'label': 'HTTP DOS with varying UA', 'description': 'Detect DoS tools switching user-agent too fast', 'references': []}, {'name': 'crowdsecurity/http-sensitive-files', 'label': 'Access to sensitive files over HTTP', 'description': 'Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)', 'references': []}], 'target_countries': {'US': 36, 'DE': 19, 'NL': 10, 'FR': 9, 'RU': 6, 'JP': 4, 'GB': 4, 'PL': 2, 'CA': 2, 'AU': 2}, 'mitre_techniques': [{'name': 'T1110', 'label': 'Brute Force', 'description': 'Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.', 'references': []}, {'name': 'T1595', 'label': 'Active Scanning', 'description': 'Adversaries may execute active reconnaissance scans to gather information that can be used during targeting.', 'references': []}, {'name': 'T1589', 'label': 'Gather Victim Identity Information', 'description': "Adversaries may gather information about the victim's identity that can be used during targeting.", 'references': []}, {'name': 'T1498', 'label': 'Network Denial of Service', 'description': 'Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users.', 'references': []}, {'name': 'T1190', 'label': 'Exploit Public-Facing Application', 'description': 'Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network.', 'references': []}], 'cves': ['CVE-2024-27956', 'CVE-2024-4577'], 'scores': {'overall': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_day': {'aggressiveness': 5, 'threat': 2, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_week': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}, 'last_month': {'aggressiveness': 5, 'threat': 1, 'trust': 5, 'anomaly': 1, 'total': 4}}, 'references': [{'name': 'list:firehol_voipbl', 'label': 'Firehol voipbl.org list', 'description': "VoIPBL.org is a distributed VoIP blacklist that is aimed to protect against VoIP fraud and minimizing abuse for networks that have publicly accessible PBX's. Several algorithms, external sources and manual confirmations are used before they categorize something as an attack and determine the threat level.", 'references': ['https://iplists.firehol.org/?ipset=voipbl']}, {'name': 'list:firehol_cruzit_web_attacks', 'label': 'Firehol cruzit.com list', 'description': 'IPs of compromised machines scanning for vulnerabilities and DDOS attacks. Provided by Cruzit.com', 'references': ['https://iplists.firehol.org/?ipset=cruzit_web_attacks']}, {'name': 'list:crowdsec_intelligence_blocklist', 'label': 'CrowdSec Intelligence Blocklist', 'description': "CrowdSec's main blocklist, containing the most aggressive IPs identified as attacking our network. It is a core anti-bot, mass attack list you should subscribe to in priority.", 'references': []}, {'name': 'list:crowdsec_high_background_noise', 'label': 'High Background Noise', 'description': 'Contains IPs considered internet background noise, identified as malicious or potential threats. Blocking these IPs can reduce further your alert volume and save infrastructure resources.', 'references': []}, {'name': 'list:crowdsec_ai_vpn_proxy', 'label': 'Extended AI-Detected VPN/Proxy', 'description': 'This list includes IPs classified as anonymization services, often involved in repeated attacks. These IPs are from lesser-known, easily controlled proxies or VPNs, not from major providers.', 'references': []}, {'name': 'list:crowdsec_cve_2024_4577', 'label': 'CrowdSec CVE-2024-4577', 'description': 'CrowdSec aggregated a list of IPs targeting CVE-2024-4577', 'references': ['https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4577']}]}
WARNING 2025-02-10 02:24:06,700 base_scanner 134489 129965641172672 securitytrails rate limit hit
